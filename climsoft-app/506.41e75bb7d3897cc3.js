"use strict";(self.webpackChunkclimsoft_app=self.webpackChunkclimsoft_app||[]).push([[506],{9309:(U,b,o)=>{o.d(b,{d:()=>T});var m=o(1135),l=o(262),g=o(8505),E=o(5e3),v=o(4691);const e="climsoft/v1/obselements";let T=(()=>{class h{constructor(n){this.http=n,this.state$=new m.X({elements:[],limit:10,page:1,pages:1}),this.init=!1;const a=this.state$.getValue();this.getElements(a.page,a.limit)}get elements(){return this.state$.asObservable()}adapt(n){const a={element_id:"Element ID",abbreviation:"Abbreviation",element_name:"Element Name",description:"Description",element_scale:"Element Scale",upper_limit:"Upper Limit",lower_limit:"Lower Limit",units:"Units",element_type:"Element Type",qc_total_required:"QC Total Required",selected:"Selected"};let c=[];return Object.keys(n).filter(r=>"elementId"!==r).forEach(r=>{c.push({key:a[r],value:n[r]||"No Value"})}),c}updateState(n){if(n.page){const a=this.state$.getValue().limit;this.getElements(n.page,a)}n.limit&&this.getElements(1,n.limit)}getElements(n,a){this.http.GET(`${e}?limit=${a}&offset=${(n-1)*a}`).subscribe(r=>{console.log(r),this.state$.next({elements:r.result,limit:a,page:r.page,pages:r.pages}),this.init=!0})}searchElements(n){return this.http.GET(`climsoft/v1/obselements/search?query=${n}`)}getElement(n){return this.http.GET(`${e}/${n}`)}addElement(n){return this.http.POST(`${e}`,Object.assign({},n)).pipe((0,l.K)(a=>{throw new Error(a.error.message)}),(0,g.b)(a=>{console.log(a);const c=this.state$.getValue(),{page:r,limit:_}=c;this.getElements(r,_)}))}updateElement(n,a){return this.http.PUT(`${e}/${n}`,a).pipe((0,l.K)(c=>{throw new Error(c.error.message)}),(0,g.b)(c=>{const r=this.state$.getValue(),{page:_,limit:I}=r;this.getElements(_,I)}))}removeElement(n){this.http.DELETE(`${e}/${n}`).pipe((0,l.K)(a=>{throw new Error(a.error.message)})).subscribe(a=>{const c=this.state$.getValue(),{page:r,limit:_}=c;this.getElements(r,_)})}}return h.\u0275fac=function(n){return new(n||h)(E.LFG(v.O))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},3543:(U,b,o)=>{o.d(b,{p:()=>T});var m=o(1135),l=o(262),g=o(8505),E=o(5e3),v=o(4691);const e="climsoft/v1";let T=(()=>{class h{constructor(n){this.http=n,this.instruments$=new m.X({instruments:[],limit:10,page:1,pages:1}),this.init=!1;const a=this.instruments$.getValue();this.getInstruments(a.page,a.limit)}get instruments(){return this.instruments$.asObservable()}adapt(n){const a={instrument_id:"",instrument_name:"Instrument Name",serial_number:"Serial Number",abbreviation:"Abbreviation",model:"Model",manufacturer:"Manufacturer",instrument_uncertainty:"Instrument Uncertainty",installation_datetime:"Installation DateTime",deinstallation_datetime:"Deinstallation DateTime",height:"Height",instrument_picture:"Instrument Picture",installed_at:"Installed At"};let c=[];return Object.keys(n).filter(r=>-1===["instrument_id","instrument_name"].indexOf(r)).forEach(r=>{const _={};switch(_.key=a[r],_.value=n[r]||"No Value",r){case"installation_datetime":case"deinstallation_datetime":_.type="date";break;default:_.type=null}c.push(_)}),c}addInstrument(n){return this.http.POST(`${e}/instruments`,Object.assign(Object.assign({},n),{installation_datetime:n.installation_datetime.toISOString(),deinstallation_datetime:n.deinstallation_datetime.toISOString()})).pipe((0,l.K)(a=>{throw new Error(a.error.message)}),(0,g.b)(a=>{console.log(a);const c=this.instruments$.getValue(),{page:r,limit:_}=c;this.getInstruments(r,_)}))}search(n){return this.http.GET(`${e}/instruments/search?query=${n}`)}updateState(n){if(n.page){const a=this.instruments$.getValue().limit;this.getInstruments(n.page,a)}n.limit&&this.getInstruments(1,n.limit)}getInstruments(n,a){console.log(n,a),this.http.GET(`${e}/instruments?limit=${a}&offset=${(n-1)*a}`).subscribe(r=>{console.log(r),this.instruments$.next({instruments:r.result,limit:a,page:r.page,pages:r.pages}),this.init=!0})}getInstrument(n){return this.http.GET(`${e}/instruments/${n}`)}updateInstrument(n,a){return this.http.PUT(`${e}/instruments/${n}`,a).pipe((0,l.K)(c=>{throw new Error(c.error.message)}),(0,g.b)(c=>{const r=this.instruments$.getValue(),{page:_,limit:I}=r;this.getInstruments(_,I)}))}removeInstrument(n){this.http.DELETE(`${e}/instruments/${n}`).pipe((0,l.K)(a=>{throw new Error(a.error.message)})).subscribe(a=>{const c=this.instruments$.getValue(),{page:r,limit:_}=c;this.getInstruments(r,_)})}}return h.\u0275fac=function(n){return new(n||h)(E.LFG(v.O))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},5329:(U,b,o)=>{o.d(b,{R:()=>e});var m=o(1135),l=o(8505),g=o(5e3),E=o(4691);const v="climsoft/v1";let e=(()=>{class T{constructor(p){this.http=p,this.state$=new m.X({classes:[],limit:10,page:1,pages:1}),this.init=!1;const n=this.state$.getValue();this.getClasses(n.page,n.limit)}get definitions(){return this.state$.asObservable()}getClasses(p,n){console.log(p,n),this.http.GET(`${v}/obs-schedule-class?limit=${n}&offset=${(p-1)*n}`).subscribe(c=>{console.log(c),this.state$.next({classes:c.result,limit:n,page:c.page,pages:c.pages}),this.init=!0})}getByStation(p){return this.http.GET(`${v}/obs-schedule-class?limit=50&offset=0&refers_to=${p}`)}addClass(p){return this.http.POST(`${v}/obs-schedule-class`,p).pipe((0,l.b)(()=>{const n=this.state$.getValue();this.getClasses(n.page,n.limit)}))}updateClass(p,n){return this.http.PUT(`${v}/obs-schedule-class/${p}`,n).pipe((0,l.b)(()=>{const a=this.state$.getValue();this.getClasses(a.page,a.limit)}))}removeClass(p){this.http.DELETE(`${v}/obs-schedule-class/${p}`).pipe((0,l.b)(()=>{const n=this.state$.getValue();this.getClasses(n.page,n.limit)})).subscribe()}updateState(p){if(p.page){const n=this.state$.getValue().limit;this.getClasses(p.page,n)}p.limit&&this.getClasses(1,p.limit)}}return T.\u0275fac=function(p){return new(p||T)(g.LFG(E.O))},T.\u0275prov=g.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},8506:(U,b,o)=>{o.d(b,{a:()=>ae});var m=o(3075),l=o(7579),g=o(8505),E=o(3900),v=o(5439),e=o(5e3),T=o(1134),h=o(7160),p=o(3543),n=o(9309),a=o(5329),c=o(9808),r=o(963),_=o(1728),I=o(7352),x=o(4127),Z=o(1773),O=o(3044),u=o(8306),S=o(8372),y=o(4004),A=o(5032),D=o(9646),$=o(8184);function F(i,d){1&i&&(e.TgZ(0,"div",3),e._UZ(1,"img",4),e._uU(2," searching..."),e.qZA())}function P(i,d){if(1&i&&(e.TgZ(0,"div",5),e._uU(1),e.qZA(),e.TgZ(2,"div",6),e._uU(3),e.qZA()),2&i){const t=d.item;e.xp6(1),e.hij("Instrument ID: ",t.instrument_id,""),e.xp6(2),e.hij(" ",t.instrument_name," ")}}const L=function(i){return{loading:i}};let N=(()=>{class i{constructor(t){this.instService=t,this.onSelection=new e.vpe,this.typeaheadLoading=!1,this.typeaheadNoResults=!1,this.loading=!1,this.search="",this.errorMessage=""}ngOnInit(){this.elements$=new u.y(t=>{t.next(this.search)}).pipe((0,S.b)(400),(0,g.b)(()=>{this.loading=!0}),(0,E.w)(t=>(console.log(t),t?this.instService.search(t).pipe((0,g.b)(()=>{this.loading=!1}),(0,y.U)(s=>s.result||[]),(0,g.b)(()=>A.Z,s=>{this.errorMessage=s&&s.message||"search failed"})):(0,D.of)([]))))}changeTypeaheadLoading(t){this.typeaheadLoading=t}onSelect(t){this.selected=t.item,this.onSelection.emit(t.item)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.p))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-instrument-selection"]],outputs:{onSelection:"onSelection"},decls:4,vars:9,consts:[["typeaheadOptionField","instrument_name","autocomplete","off","autocorrect","off","placeholder","Instrument",1,"form-control",3,"ngModel","typeahead","typeaheadAsync","typeaheadOptionsLimit","typeaheadItemTemplate","ngClass","ngModelChange","typeaheadLoading","typeaheadOnSelect"],["class","typeahead-loading",4,"ngIf"],["itemTemplate",""],[1,"typeahead-loading"],["src","./assets/img/gif/spinner.gif","alt",""],[1,"item-heading"],[1,"item-title"]],template:function(t,s){if(1&t&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(C){return s.search=C})("typeaheadLoading",function(C){return s.changeTypeaheadLoading(C)})("typeaheadOnSelect",function(C){return s.onSelect(C)}),e.qZA(),e.YNc(1,F,3,0,"div",1),e.YNc(2,P,4,2,"ng-template",null,2,e.W1O)),2&t){const f=e.MAs(3);e.Q6J("ngModel",s.search)("typeahead",s.elements$)("typeaheadAsync",!0)("typeaheadOptionsLimit",7)("typeaheadItemTemplate",f)("ngClass",e.VKq(7,L,s.typeaheadLoading)),e.xp6(1),e.Q6J("ngIf",s.loading)}},directives:[m.Fj,m.JJ,m.On,$.Bp,c.mk,c.O5],styles:[""]}),i})();function q(i,d){1&i&&(e.TgZ(0,"c-alert",37),e.TgZ(1,"strong"),e._uU(2,"Error(s)!"),e.qZA(),e._uU(3," Please correct the following errors."),e.qZA())}function J(i,d){1&i&&(e.TgZ(0,"c-col",38),e._UZ(1,"app-infinite-loading"),e.qZA())}function Y(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"a",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).resetStation()}),e.O4$(),e._UZ(1,"svg",43),e.qZA()}}function K(i,d){if(1&i&&(e.TgZ(0,"div",39),e.TgZ(1,"div",40),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.YNc(4,Y,2,0,"a",41),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.station.station_name),e.xp6(1),e.Q6J("ngIf",!t.fromStation)}}function V(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"app-station-selection",44),e.NdJ("onSelection",function(f){return e.CHM(t),e.oxw().onStationSelect(f)}),e.qZA()}}function B(i,d){1&i&&(e.TgZ(0,"div"),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Station selection required."),e.qZA())}function R(i,d){if(1&i&&(e.TgZ(0,"div",45),e.YNc(1,B,3,0,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.recorded_from.errors.required)}}function w(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",39),e.TgZ(1,"div",40),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"a",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().resetElement()}),e.O4$(),e._UZ(5,"svg",43),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.element.element_name)}}function Q(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"app-element-selection",44),e.NdJ("onSelection",function(f){return e.CHM(t),e.oxw().onElementSelect(f)}),e.qZA()}}function W(i,d){1&i&&(e.TgZ(0,"div"),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Element selection required."),e.qZA())}function j(i,d){if(1&i&&(e.TgZ(0,"div",45),e.YNc(1,W,3,0,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.described_by.errors.required)}}function G(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",39),e.TgZ(1,"div",40),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"a",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().resetElement()}),e.O4$(),e._UZ(5,"svg",43),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.instrument.instrument_name)}}function H(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"app-instrument-selection",44),e.NdJ("onSelection",function(f){return e.CHM(t),e.oxw().onInstrumentSelect(f)}),e.qZA()}}function X(i,d){1&i&&(e.TgZ(0,"div"),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Instrument selection required."),e.qZA())}function z(i,d){if(1&i&&(e.TgZ(0,"div",45),e.YNc(1,X,3,0,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.recorded_with.errors.required)}}function k(i,d){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.schedule_class),e.xp6(1),e.Oqu(t.schedule_class)}}function ee(i,d){1&i&&(e.TgZ(0,"div"),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Schedule Class is required."),e.qZA())}function te(i,d){if(1&i&&(e.TgZ(0,"div",45),e.YNc(1,ee,3,0,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.scheduled_for.errors.required)}}function ne(i,d){1&i&&(e.TgZ(0,"div",49),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Begin date is required. "),e.qZA())}function ie(i,d){1&i&&(e.TgZ(0,"div",49),e.O4$(),e._UZ(1,"svg",47),e._uU(2," End date is required. "),e.qZA())}function se(i,d){1&i&&(e.TgZ(0,"div"),e.O4$(),e._UZ(1,"svg",47),e._uU(2," Height is required."),e.qZA())}function oe(i,d){if(1&i&&(e.TgZ(0,"div",45),e.YNc(1,se,3,0,"div",46),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.height.errors.required)}}const M=function(i){return{"is-invalid":i}};let ae=(()=>{class i{constructor(t,s,f,C,le){this.dialogRef=t,this.stationService=s,this.instrumentService=f,this.obsElService=C,this.schClassService=le,this.onClose=new l.x,this.submitted=!1,this.loading=!1,this.bsConfig={isAnimated:!0,containerClass:"theme-blue",dateInputFormat:"DD/MM/YYYY"},this.scheduleClasses=[]}get update(){return!!this.stationElement}ngOnInit(){console.log(this.stationElement),this.form=new m.cw({recorded_from:new m.NI(null,m.kI.required),described_by:new m.NI(null,m.kI.required),recorded_with:new m.NI(null,m.kI.required),scheduled_for:new m.NI({value:"",disabled:!0},m.kI.required),begin_date:new m.NI(null,m.kI.required),end_date:new m.NI(null),height:new m.NI(null,m.kI.required)}),this.fromStation&&(this.form.controls.recorded_from.setValue(this.fromStation.station_id),this.station=this.fromStation,this.loadScheduleClasses(this.station.station_id)),this.stationElement&&this.loadDependencies()}resetStation(){this.station=void 0,this.form.controls.recorded_from.reset()}onStationSelect(t){this.station=t,this.form.controls.recorded_from.setValue(t.station_id),this.loadScheduleClasses(this.station.station_id),this.f.scheduled_for.setValue(""),this.f.scheduled_for.disable()}resetElement(){this.element=void 0,this.form.controls.described_by.reset()}onElementSelect(t){this.element=t,this.form.controls.described_by.setValue(t.element_id)}resetInstrument(){this.element=void 0,this.form.controls.recorded_with.reset()}onInstrumentSelect(t){this.instrument=t,this.form.controls.recorded_with.setValue(t.instrument_id)}onBeginDateChanged(t){t&&(this.form.controls.begin_date.setValue(t.toISOString()),this.minDate=v(t).add(1,"day").toDate())}onEndDateChanged(t){t&&this.form.controls.end_date.setValue(t.toISOString())}onSubmit(t){console.log(this.form.value),this.submitted=!0,!this.form.invalid&&(this.onClose.next(this.form.value),this.dialogRef.hide())}onCancel(){this.onClose.next(!1),this.dialogRef.hide()}get f(){return this.form.controls}loadScheduleClasses(t){this.scheduleClasses=[],this.schClassService.getByStation(t).subscribe(s=>{this.scheduleClasses=s.result,this.f.scheduled_for.enable()})}loadDependencies(){this.loading=!0,this.loadScheduleClasses(this.stationElement.recorded_from),this.stationService.getStation(+this.stationElement.recorded_from).pipe((0,g.b)(t=>this.station=t.result[0]),(0,E.w)(()=>this.obsElService.getElement(this.stationElement.described_by))).pipe((0,g.b)(t=>this.element=t.result[0]),(0,E.w)(()=>this.instrumentService.getInstrument(+this.stationElement.recorded_with))).subscribe(t=>{this.instrument=t.result[0],this.loading=!1}),this.form.patchValue(Object.assign({},this.stationElement)),this.bsBegin=new Date(this.stationElement.begin_date)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(T.UZ),e.Y36(h.v),e.Y36(p.p),e.Y36(n.d),e.Y36(a.R))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-station-element-form"]],inputs:{stationElement:"stationElement",fromStation:"fromStation"},decls:74,vars:41,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],["color","danger",4,"ngIf"],["cForm","","novalidate","",3,"formGroup","ngSubmit"],["xs","12",4,"ngIf"],["xs","12","md","6","lg","5"],[1,"mb-2"],["cLabel","","for","station"],["id","station","type","hidden","formControlName","recorded_from","aria-label","default input","cFormControl",""],["class","typeahead-selection theme form-group",4,"ngIf"],[3,"onSelection",4,"ngIf"],["col","12","class","invalid-feedback",4,"ngIf"],["cLabel","","for","element"],["id","element","type","hidden","formControlName","described_by","aria-label","default input","cFormControl",""],["cLabel","","for","instrument"],["id","instrument","type","hidden","formControlName","recorded_with","aria-label","default input","cFormControl",""],[1,"mb-3"],["cLabel","","for","scheduled_for"],["id","scheduled_for","formControlName","scheduled_for","cSelect","",3,"ngClass"],["value",""],[3,"value",4,"ngFor","ngForOf"],["cLabel","","for","begin_date"],["cInputGroupText",""],["cIcon","","name","cilCalendar"],["id","begin_date","type","hidden","formControlName","begin_date","aria-label","default input","cFormControl",""],["name","monthYear","placeholder","Select Begin Date","cFormControl","","bsDatepicker","","autocomplete","off",3,"bsValue","ngClass","bsConfig","bsValueChange"],["sm","12","class","invalid-feedback",4,"ngIf"],["cLabel","","for","end_date"],["id","end_date","type","hidden","formControlName","end_date","aria-label","default input","cFormControl",""],["name","monthYear","placeholder","Select End Date","cFormControl","","bsDatepicker","","autocomplete","off",3,"bsValue","ngClass","bsConfig","minDate","bsValueChange"],["cLabel","","for","height"],["id","height","formControlName","height","aria-label","default input","cFormControl","","placeholder","Height",3,"ngClass"],[1,"mt-4"],["xs","12",1,"text-start","py-3"],["type","submit",1,"btn","btn-dark","mx-1"],["type","button",1,"btn","btn-dark",3,"click"],["color","danger"],["xs","12"],[1,"typeahead-selection","theme","form-group"],[1,"typeahead-selection-inner"],["class","btn",3,"click",4,"ngIf"],[1,"btn",3,"click"],["cIcon","","name","cilX"],[3,"onSelection"],["col","12",1,"invalid-feedback"],[4,"ngIf"],["cIcon","","name","cilXCircle"],[3,"value"],["sm","12",1,"invalid-feedback"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h5",1),e._uU(2),e.qZA(),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,q,4,0,"c-alert",3),e.TgZ(5,"form",4),e.NdJ("ngSubmit",function(C){return s.onSubmit(C)}),e.TgZ(6,"c-row"),e.YNc(7,J,2,0,"c-col",5),e.TgZ(8,"c-col",6),e.TgZ(9,"div",7),e.TgZ(10,"label",8),e._uU(11,"Station"),e.qZA(),e._UZ(12,"input",9),e.YNc(13,K,5,2,"div",10),e.YNc(14,V,1,0,"app-station-selection",11),e.YNc(15,R,2,1,"div",12),e.qZA(),e.qZA(),e.TgZ(16,"c-col",6),e.TgZ(17,"div",7),e.TgZ(18,"label",13),e._uU(19,"Element"),e.qZA(),e._UZ(20,"input",14),e.YNc(21,w,6,1,"div",10),e.YNc(22,Q,1,0,"app-element-selection",11),e.YNc(23,j,2,1,"div",12),e.qZA(),e.qZA(),e.TgZ(24,"c-col",6),e.TgZ(25,"div",7),e.TgZ(26,"label",15),e._uU(27,"Instrument"),e.qZA(),e._UZ(28,"input",16),e.YNc(29,G,6,1,"div",10),e.YNc(30,H,1,0,"app-instrument-selection",11),e.YNc(31,z,2,1,"div",12),e.qZA(),e.qZA(),e.TgZ(32,"c-col",6),e.TgZ(33,"div",17),e.TgZ(34,"label",18),e._uU(35,"Classified Into"),e.qZA(),e.TgZ(36,"select",19),e.TgZ(37,"option",20),e._uU(38,"Select Schedule For"),e.qZA(),e.YNc(39,k,2,2,"option",21),e.qZA(),e.YNc(40,te,2,1,"div",12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"c-row"),e.TgZ(42,"c-col",6),e.TgZ(43,"label",22),e._uU(44,"Begin Date"),e.qZA(),e.TgZ(45,"c-input-group",17),e.TgZ(46,"span",23),e.O4$(),e._UZ(47,"svg",24),e.qZA(),e.kcU(),e._UZ(48,"input",25),e.TgZ(49,"input",26),e.NdJ("bsValueChange",function(C){return s.onBeginDateChanged(C)}),e.qZA(),e.YNc(50,ne,3,0,"div",27),e.qZA(),e.qZA(),e.TgZ(51,"c-col",6),e.TgZ(52,"label",28),e._uU(53,"End Date"),e.qZA(),e.TgZ(54,"c-input-group",17),e.TgZ(55,"span",23),e.O4$(),e._UZ(56,"svg",24),e.qZA(),e.kcU(),e._UZ(57,"input",29),e.TgZ(58,"input",30),e.NdJ("bsValueChange",function(C){return s.onEndDateChanged(C)}),e.qZA(),e.YNc(59,ie,3,0,"div",27),e.qZA(),e.qZA(),e.qZA(),e.TgZ(60,"c-row"),e.TgZ(61,"c-col",6),e.TgZ(62,"div",7),e.TgZ(63,"label",31),e._uU(64,"Height"),e.qZA(),e._UZ(65,"input",32),e.YNc(66,oe,2,1,"div",12),e.qZA(),e.qZA(),e.qZA(),e._UZ(67,"hr"),e.TgZ(68,"c-row",33),e.TgZ(69,"c-col",34),e.TgZ(70,"button",35),e._uU(71),e.qZA(),e.TgZ(72,"button",36),e.NdJ("click",function(){return s.onCancel()}),e._uU(73,"Cancel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.hij("",s.update?"Update":"Add"," Station Element"),e.xp6(2),e.Q6J("ngIf",s.submitted&&s.form.invalid),e.xp6(1),e.Q6J("formGroup",s.form),e.xp6(2),e.Q6J("ngIf",s.loading),e.xp6(6),e.Q6J("ngIf",s.station),e.xp6(1),e.Q6J("ngIf",!s.station&&!s.update),e.xp6(1),e.Q6J("ngIf",s.f.recorded_from.errors),e.xp6(5),e.uIk("disabled",s.update),e.xp6(1),e.Q6J("ngIf",s.element),e.xp6(1),e.Q6J("ngIf",!s.element&&!s.update),e.xp6(1),e.Q6J("ngIf",s.f.described_by.errors),e.xp6(5),e.uIk("disabled",s.update),e.xp6(1),e.Q6J("ngIf",s.instrument),e.xp6(1),e.Q6J("ngIf",!s.instrument&&!s.update),e.xp6(1),e.Q6J("ngIf",s.f.recorded_with.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(31,M,(s.submitted||s.f.scheduled_for.touched)&&s.f.scheduled_for.invalid))("ngClass",e.VKq(33,M,(s.submitted||s.f.scheduled_for.touched)&&s.f.scheduled_for.invalid)),e.xp6(3),e.Q6J("ngForOf",s.scheduleClasses),e.xp6(1),e.Q6J("ngIf",s.submitted&&s.f.scheduled_for.errors),e.xp6(9),e.Q6J("bsValue",s.bsBegin)("ngClass",e.VKq(35,M,s.submitted&&s.f.begin_date.invalid))("bsConfig",s.bsConfig),e.xp6(1),e.Q6J("ngIf",s.submitted&&s.f.begin_date.invalid),e.xp6(8),e.Q6J("bsValue",s.bsEnd)("ngClass",e.VKq(37,M,s.submitted&&s.f.end_date.invalid))("bsConfig",s.bsConfig)("minDate",s.minDate),e.xp6(1),e.Q6J("ngIf",s.submitted&&s.f.end_date.invalid),e.xp6(6),e.Q6J("ngClass",e.VKq(39,M,(s.submitted||s.f.height.touched)&&s.f.height.invalid)),e.xp6(1),e.Q6J("ngIf",s.f.height.errors),e.xp6(5),e.Oqu(s.update?"Update":"Add"))},directives:[c.O5,m._Y,m.JL,r.$_X,m.sg,r.iok,r.Yp0,r.eFW,m.Fj,r.oHf,m.JJ,m.u,m.EJ,r.nqR,c.mk,m.YN,m.Kr,c.sg,r.g8K,r.jOm,_.ar,I.Y5,I.Np,r.wxo,x.$,Z.n,O.Y,N],styles:[""]}),i})()},3044:(U,b,o)=>{o.d(b,{Y:()=>x});var m=o(8505),l=o(5e3),g=o(8306),E=o(8372),v=o(3900),e=o(4004),T=o(5032),h=o(9646),p=o(9309),n=o(3075),a=o(8184),c=o(9808);function r(Z,O){1&Z&&(l.TgZ(0,"div",3),l._UZ(1,"img",4),l._uU(2," searching..."),l.qZA())}function _(Z,O){if(1&Z&&(l.TgZ(0,"div",5),l._uU(1),l.qZA(),l.TgZ(2,"div",6),l._uU(3),l.qZA()),2&Z){const u=O.item;l.xp6(1),l.AsE("",u.element_id," - ",u.abbreviation,""),l.xp6(2),l.hij(" ",u.element_name," ")}}const I=function(Z){return{loading:Z}};let x=(()=>{class Z{constructor(u){this.elementService=u,this.onSelection=new l.vpe,this.typeaheadLoading=!1,this.typeaheadNoResults=!1,this.loading=!1,this.search="",this.errorMessage=""}ngOnInit(){this.elements$=new g.y(u=>{u.next(this.search)}).pipe((0,E.b)(400),(0,m.b)(()=>{this.loading=!0}),(0,v.w)(u=>(console.log(u),u?this.elementService.searchElements(u).pipe((0,m.b)(()=>{this.loading=!1}),(0,e.U)(S=>S.result||[]),(0,m.b)(()=>T.Z,S=>{this.errorMessage=S&&S.message||"search failed"})):(0,h.of)([]))))}changeTypeaheadLoading(u){this.typeaheadLoading=u}onSelect(u){this.selected=u.item,this.onSelection.emit(u.item)}}return Z.\u0275fac=function(u){return new(u||Z)(l.Y36(p.d))},Z.\u0275cmp=l.Xpm({type:Z,selectors:[["app-element-selection"]],outputs:{onSelection:"onSelection"},decls:4,vars:9,consts:[["typeaheadOptionField","element_name","autocomplete","off","autocorrect","off","placeholder","Described By",1,"form-control",3,"ngModel","typeahead","typeaheadAsync","typeaheadOptionsLimit","typeaheadItemTemplate","ngClass","ngModelChange","typeaheadLoading","typeaheadOnSelect"],["class","typeahead-loading",4,"ngIf"],["itemTemplate",""],[1,"typeahead-loading"],["src","./assets/img/gif/spinner.gif","alt",""],[1,"item-heading"],[1,"item-title"]],template:function(u,S){if(1&u&&(l.TgZ(0,"input",0),l.NdJ("ngModelChange",function(A){return S.search=A})("typeaheadLoading",function(A){return S.changeTypeaheadLoading(A)})("typeaheadOnSelect",function(A){return S.onSelect(A)}),l.qZA(),l.YNc(1,r,3,0,"div",1),l.YNc(2,_,4,3,"ng-template",null,2,l.W1O)),2&u){const y=l.MAs(3);l.Q6J("ngModel",S.search)("typeahead",S.elements$)("typeaheadAsync",!0)("typeaheadOptionsLimit",7)("typeaheadItemTemplate",y)("ngClass",l.VKq(7,I,S.typeaheadLoading)),l.xp6(1),l.Q6J("ngIf",S.loading)}},directives:[n.Fj,n.JJ,n.On,a.Bp,c.mk,c.O5],styles:[".item-heading[_ngcontent-%COMP%]{font-size:.7rem}.item-title[_ngcontent-%COMP%]{font-size:.9rem}"]}),Z})()},4127:(U,b,o)=>{o.d(b,{$:()=>l});var m=o(5e3);let l=(()=>{class g{constructor(){}ngOnInit(){}}return g.\u0275fac=function(v){return new(v||g)},g.\u0275cmp=m.Xpm({type:g,selectors:[["app-infinite-loading"]],decls:2,vars:0,consts:[[1,"infinite-loader"],[1,"loader-bar"]],template:function(v,e){1&v&&(m.TgZ(0,"div",0),m._UZ(1,"div",1),m.qZA())},styles:['.infinite-loader[_ngcontent-%COMP%]{width:100%;margin:0 auto;border-radius:10px;border:4px solid transparent;position:relative;padding:1px}.infinite-loader[_ngcontent-%COMP%]:before{content:"";border:1px solid #1697ec;border-radius:10px;position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px}.infinite-loader[_ngcontent-%COMP%]   .loader-bar[_ngcontent-%COMP%]{position:absolute;border-radius:10px;top:0;right:100%;bottom:0;left:0;background:#1697ec;width:0;animation:borealisBar 1s linear infinite}@keyframes borealisBar{0%{left:0%;right:100%;width:0%}10%{left:0%;right:75%;width:25%}90%{right:0%;left:75%;width:25%}to{left:100%;right:0%;width:0%}}']}),g})()}}]);