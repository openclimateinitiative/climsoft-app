"use strict";(self.webpackChunkclimsoft_app=self.webpackChunkclimsoft_app||[]).push([[457],{3457:($,P,a)=>{a.r(P),a.d(P,{ScheduleClassModule:()=>Y});var e=a(9808),m=a(9461),A=a(9291),O=a(9646),S=a(8505),g=a(9300),Z=a(3900),d=a(703),c=a(3075),n=a(7579),i=a(4004),t=a(5e3),r=a(1134),h=a(7160),u=a(963),y=a(1728),E=a(1773);function v(o,_){if(1&o&&(t.TgZ(0,"c-col",5),t.TgZ(1,"c-alert",19),t.O4$(),t._UZ(2,"svg",20),t._uU(3),t.qZA(),t.qZA()),2&o){const s=t.oxw();t.xp6(3),t.hij(" ",s.error,"")}}function C(o,_){1&o&&(t.TgZ(0,"div"),t.O4$(),t._UZ(1,"svg",20),t._uU(2," Form ID is required."),t.qZA())}function M(o,_){if(1&o&&(t.TgZ(0,"div",21),t.YNc(1,C,3,0,"div",22),t.qZA()),2&o){const s=t.oxw();t.xp6(1),t.Q6J("ngIf",s.f.schedule_class.errors.required)}}function p(o,_){if(1&o){const s=t.EpF();t.TgZ(0,"a",26),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).resetStation()}),t.O4$(),t._UZ(1,"svg",27),t.qZA()}}function f(o,_){if(1&o&&(t.TgZ(0,"div",23),t.TgZ(1,"div",24),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.YNc(4,p,2,0,"a",25),t.qZA(),t.qZA()),2&o){const s=t.oxw();t.xp6(3),t.Oqu(s.station.station_name),t.xp6(1),t.Q6J("ngIf",!s.fromStation)}}function I(o,_){if(1&o){const s=t.EpF();t.TgZ(0,"app-station-selection",28),t.NdJ("onSelection",function(U){return t.CHM(s),t.oxw().onStationSelect(U)}),t.qZA()}}function b(o,_){1&o&&(t.TgZ(0,"div"),t.O4$(),t._UZ(1,"svg",20),t._uU(2," Station selection required."),t.qZA())}function F(o,_){if(1&o&&(t.TgZ(0,"div",21),t.YNc(1,b,3,0,"div",22),t.qZA()),2&o){const s=t.oxw();t.xp6(1),t.Q6J("ngIf",s.f.refers_to.errors.required)}}function J(o,_){1&o&&(t.TgZ(0,"div"),t.O4$(),t._UZ(1,"svg",20),t._uU(2," Description not selected."),t.qZA())}function N(o,_){if(1&o&&(t.TgZ(0,"div",21),t.YNc(1,J,3,0,"div",22),t.qZA()),2&o){const s=t.oxw();t.xp6(1),t.Q6J("ngIf",s.f.description.errors.required)}}const L=function(o){return{"is-invalid":o}};let q=(()=>{class o{constructor(s,l){this.dialogRef=s,this.stationService=l,this.onClose=new n.x,this.submitted=!1}ngOnInit(){console.log(this.repeatPayload),this.form=new c.cw({refers_to:new c.NI("",c.kI.required),schedule_class:new c.NI("",c.kI.required),description:new c.NI("")}),this.scheduleClass&&(this.form.patchValue(this.scheduleClass),this.f.schedule_class.disable(),this.station={station_name:this.scheduleClass.refers_to,station_id:+this.scheduleClass.refers_to}),this.repeatPayload&&(this.form.patchValue(this.repeatPayload),this.initStation(this.repeatPayload.refers_to))}get update(){return!!this.scheduleClass}get f(){return this.form.controls}onStationSelect(s){this.station=s,this.form.controls.refers_to.setValue(s.station_id)}resetStation(){this.station=void 0,this.form.controls.station.reset()}onSubmit(s){this.submitted=!0,!this.form.invalid&&(this.onClose.next(this.update?{refers_to:this.f.refers_to.value,description:this.f.description.value}:this.form.value),this.dialogRef.hide())}onCancel(){this.onClose.next(!1),this.dialogRef.hide()}initStation(s){this.stationService.getStation(s).pipe((0,g.h)(l=>l.result.length),(0,i.U)(l=>l.result[0])).subscribe(l=>this.station=l)}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(r.UZ),t.Y36(h.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-schedule-class-form"]],inputs:{scheduleClass:"scheduleClass",fromStation:"fromStation",repeatPayload:"repeatPayload",error:"error"},decls:35,vars:15,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],["cForm","","novalidate","",3,"formGroup","ngSubmit"],["xs","12",4,"ngIf"],["xs","12"],[1,"mb-2"],["cLabel","","for","schedule_class"],["id","schedule_class","formControlName","schedule_class","aria-label","default input","cFormControl","","placeholder","Schedule Class",3,"ngClass"],["col","12","class","invalid-feedback",4,"ngIf"],["cLabel","","for","station"],["id","station","type","hidden","formControlName","refers_to","aria-label","default input","cFormControl",""],["class","typeahead-selection theme form-group",4,"ngIf"],[3,"onSelection",4,"ngIf"],["cLabel","","for","description"],["id","description","formControlName","description","aria-label","default input","cFormControl","","placeholder","Description","rows","3",3,"ngClass"],["xs","12",1,"text-end","pt-3"],["type","submit",1,"btn","btn-dark","mx-1"],["type","button",1,"btn","btn-dark",3,"click"],["color","danger"],["cIcon","","name","cilXCircle"],["col","12",1,"invalid-feedback"],[4,"ngIf"],[1,"typeahead-selection","theme","form-group"],[1,"typeahead-selection-inner"],["class","btn",3,"click",4,"ngIf"],[1,"btn",3,"click"],["cIcon","","name","cilX"],[3,"onSelection"]],template:function(s,l){1&s&&(t.TgZ(0,"div",0),t.TgZ(1,"h5",1),t._uU(2),t.qZA(),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"form",3),t.NdJ("ngSubmit",function(T){return l.onSubmit(T)}),t.TgZ(5,"c-row"),t.YNc(6,v,4,1,"c-col",4),t.TgZ(7,"c-col",5),t.TgZ(8,"div",6),t.TgZ(9,"label",7),t._uU(10,"Schedule Class"),t.qZA(),t._UZ(11,"input",8),t.YNc(12,M,2,1,"div",9),t.qZA(),t.qZA(),t.TgZ(13,"c-col",5),t.TgZ(14,"div",6),t.TgZ(15,"label",10),t._uU(16,"Station"),t.qZA(),t._UZ(17,"input",11),t.YNc(18,f,5,2,"div",12),t.YNc(19,I,1,0,"app-station-selection",13),t.YNc(20,F,2,1,"div",9),t.qZA(),t.qZA(),t.TgZ(21,"c-col",5),t.TgZ(22,"div",6),t.TgZ(23,"label",14),t._uU(24,"Description"),t.qZA(),t._UZ(25,"textarea",15),t.YNc(26,N,2,1,"div",9),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"c-row"),t.TgZ(28,"c-col",5),t._UZ(29,"hr"),t.qZA(),t.TgZ(30,"c-col",16),t.TgZ(31,"button",17),t._uU(32),t.qZA(),t.TgZ(33,"button",18),t.NdJ("click",function(){return l.onCancel()}),t._uU(34,"Cancel"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&s&&(t.xp6(2),t.hij("",l.update?"Update":"Add"," Schedule Class"),t.xp6(2),t.Q6J("formGroup",l.form),t.xp6(2),t.Q6J("ngIf",l.error),t.xp6(5),t.Q6J("ngClass",t.VKq(11,L,(l.submitted||l.f.schedule_class.touched)&&l.f.schedule_class.invalid)),t.xp6(1),t.Q6J("ngIf",l.f.schedule_class.errors),t.xp6(6),t.Q6J("ngIf",l.station),t.xp6(1),t.Q6J("ngIf",!l.station),t.xp6(1),t.Q6J("ngIf",l.f.refers_to.errors),t.xp6(5),t.Q6J("ngClass",t.VKq(13,L,(l.submitted||l.f.description.touched)&&l.f.description.invalid)),t.xp6(1),t.Q6J("ngIf",l.f.description.errors),t.xp6(6),t.Oqu(l.update?"Update":"Add"))},directives:[c._Y,c.JL,u.$_X,c.sg,u.iok,e.O5,u.Yp0,u.eFW,c.Fj,u.oHf,c.JJ,c.u,e.mk,u.wxo,y.ar,E.n],styles:[""]}),o})();var R=a(5329),B=a(5683);function K(o,_){if(1&o){const s=t.EpF();t.TgZ(0,"tr"),t._uU(1,"\n            "),t.TgZ(2,"td",13),t._uU(3),t.qZA(),t._uU(4,"\n            "),t.TgZ(5,"td",13),t._uU(6),t.qZA(),t._uU(7,"\n            "),t.TgZ(8,"th",13),t._uU(9),t.qZA(),t._uU(10,"\n            "),t.TgZ(11,"td"),t._uU(12,"\n              "),t.TgZ(13,"button",14),t.NdJ("click",function(){const T=t.CHM(s).$implicit;return t.oxw(2).update(T)}),t._uU(14,"\n                "),t.O4$(),t._UZ(15,"svg",15),t._uU(16,"\n              "),t.qZA(),t._uU(17,"\n              "),t.kcU(),t.TgZ(18,"button",16),t.NdJ("click",function(){const T=t.CHM(s).$implicit;return t.oxw(2).remove(T)}),t._uU(19,"\n                "),t.O4$(),t._UZ(20,"svg",17),t._uU(21,"\n              "),t.qZA(),t._uU(22,"\n            "),t.qZA(),t._uU(23,"\n          "),t.qZA()}if(2&o){const s=_.$implicit;t.xp6(3),t.hij(" ",s.schedule_class," "),t.xp6(3),t.Oqu(s.refers_to),t.xp6(3),t.Oqu(s.description)}}function Q(o,_){1&o&&(t.TgZ(0,"c-alert",18),t.TgZ(1,"strong"),t._uU(2,"Info"),t.qZA(),t._uU(3," No schedule classes available to show. "),t.qZA())}function k(o,_){if(1&o){const s=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"c-card-body"),t._uU(1,"\n        "),t.TgZ(2,"app-paginator",8),t.NdJ("onPage",function(U){return t.CHM(s),t.oxw().onPage(U)}),t.qZA(),t._uU(3,"\n        "),t.TgZ(4,"table",9),t._uU(5,"\n          "),t.TgZ(6,"thead"),t._uU(7,"\n          "),t.TgZ(8,"tr"),t._uU(9,"\n            "),t.TgZ(10,"th",10),t._uU(11,"Schedule Class"),t.qZA(),t._uU(12,"\n            "),t.TgZ(13,"th",10),t._uU(14,"Station ID"),t.qZA(),t._uU(15,"\n            "),t.TgZ(16,"th",10),t._uU(17,"Description"),t.qZA(),t._uU(18,"\n            "),t._UZ(19,"th"),t._uU(20,"\n          "),t.qZA(),t._uU(21,"\n          "),t.qZA(),t._uU(22,"\n          "),t.TgZ(23,"tbody"),t._uU(24,"\n          "),t.YNc(25,K,24,3,"tr",11),t._uU(26,"\n          "),t.qZA(),t._uU(27,"\n        "),t.qZA(),t._uU(28,"\n        "),t.YNc(29,Q,4,0,"c-alert",12),t._uU(30,"\n      "),t.qZA()}if(2&o){const s=_.$implicit,l=t.oxw();t.xp6(2),t.Q6J("limit",s.limit)("current",s.page)("pages",l.createPages(s.pages)),t.xp6(23),t.Q6J("ngForOf",s.classes),t.xp6(4),t.Q6J("ngIf",!s.classes.length)}}const w=[{path:"",component:(()=>{class o{constructor(s,l){this.modalService=s,this.schClassService=l,this.page=1,this.limit=10,this.state$=(0,O.of)({classes:[],limit:1,page:1,pages:1})}ngOnInit(){this.state$=this.schClassService.definitions}add(s,l){const T=this.modalService.show(q,{initialState:{repeatPayload:s,error:l},class:"modal-md",backdrop:"static",keyboard:!1});let D=null;T.content.onClose.pipe((0,g.h)(x=>!!x),(0,S.b)(x=>D=x),(0,Z.w)(x=>this.schClassService.addClass(x))).subscribe(x=>{console.log(x),"error"===x.status&&this.add(D,x.message)})}update(s){this.modalService.show(q,{initialState:{scheduleClass:s},class:"modal-sm",backdrop:"static",keyboard:!1}).content.onClose.pipe((0,g.h)(T=>!!T),(0,Z.w)(T=>this.schClassService.updateClass(s.schedule_class,T))).subscribe()}remove(s){this.modalService.show(d.S,{initialState:{title:"Schedule Class Removal",message:"Operation cannot be undone. Are you sure you want to remove the selected schedule class?",confirm:"Go Ahead",cancel:"Cancel"}}).content.onClose.subscribe(T=>{T&&this.schClassService.removeClass(s.schedule_class)})}onPage(s){console.log(s),this.schClassService.updateState(s)}createPages(s){return[...Array(s).keys()].map(l=>l+1)}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(r.tT),t.Y36(R.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-schedule-classes"]],decls:31,vars:3,consts:[["xs","12","lg","12","xl","12"],[1,"mb-4"],["xs","6"],[1,"col-6"],["xs","6",1,"text-end"],[1,"btn","btn-sm","cs-btn-sm","btn-outline",3,"click"],["cIcon","","name","cilPlus"],[4,"ngIf"],[3,"limit","current","pages","onPage"],["cTable",""],["scope","col"],[4,"ngFor","ngForOf"],["color","primary",4,"ngIf"],["scope","row"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Update Archive",3,"click"],["cIcon","","name","cilPencil","size","sm"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Remove Archive",3,"click"],["cIcon","","name","cilTrash","size","sm",1,"text-danger"],["color","primary"]],template:function(s,l){1&s&&(t.TgZ(0,"c-row"),t._uU(1,"\n  "),t.TgZ(2,"c-col",0),t._uU(3,"\n    "),t.TgZ(4,"c-card",1),t._uU(5,"\n      "),t.TgZ(6,"c-card-header"),t._uU(7,"\n        "),t.TgZ(8,"c-row"),t._uU(9,"\n          "),t.TgZ(10,"c-col",2),t._uU(11,"\n            "),t.TgZ(12,"strong",3),t._uU(13,"Schedule Classes"),t.qZA(),t._uU(14,"\n          "),t.qZA(),t._uU(15,"\n          "),t.TgZ(16,"c-col",4),t._uU(17,"\n            "),t.TgZ(18,"a",5),t.NdJ("click",function(){return l.add()}),t._uU(19," "),t.O4$(),t._UZ(20,"svg",6),t._uU(21," Add New "),t.qZA(),t._uU(22,"\n          "),t.qZA(),t._uU(23,"\n        "),t.qZA(),t._uU(24,"\n      "),t.qZA(),t._uU(25,"\n      "),t.YNc(26,k,31,5,"c-card-body",7),t.ALo(27,"async"),t._uU(28,"\n    "),t.qZA(),t._uU(29,"\n  "),t.qZA(),t._uU(30,"\n"),t.qZA()),2&s&&(t.xp6(26),t.Q6J("ngIf",t.lcZ(27,1,l.state$)))},directives:[u.iok,u.Yp0,u.AkF,u.nkx,y.ar,e.O5,u.yue,B.J,u.auY,e.sg,u.Hq3,u.i9q,u.wxo],pipes:[e.Ov],styles:[""]}),o})(),data:{title:"Schedule Classes"}}];let W=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[A.Bz.forChild(w)],A.Bz]}),o})(),Y=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[e.ez,m.m,W]]}),o})()},5329:($,P,a)=>{a.d(P,{R:()=>g});var e=a(1135),m=a(8505),A=a(5e3),O=a(4691);const S="climsoft/v1";let g=(()=>{class Z{constructor(c){this.http=c,this.state$=new e.X({classes:[],limit:10,page:1,pages:1}),this.init=!1;const n=this.state$.getValue();this.getClasses(n.page,n.limit)}get definitions(){return this.state$.asObservable()}getClasses(c,n){console.log(c,n),this.http.GET(`${S}/obs-schedule-class?limit=${n}&offset=${(c-1)*n}`).subscribe(t=>{console.log(t),this.state$.next({classes:t.result,limit:n,page:t.page,pages:t.pages}),this.init=!0})}getByStation(c){return this.http.GET(`${S}/obs-schedule-class?limit=50&offset=0&refers_to=${c}`)}addClass(c){return this.http.POST(`${S}/obs-schedule-class`,c).pipe((0,m.b)(()=>{const n=this.state$.getValue();this.getClasses(n.page,n.limit)}))}updateClass(c,n){return this.http.PUT(`${S}/obs-schedule-class/${c}`,n).pipe((0,m.b)(()=>{const i=this.state$.getValue();this.getClasses(i.page,i.limit)}))}removeClass(c){this.http.DELETE(`${S}/obs-schedule-class/${c}`).pipe((0,m.b)(()=>{const n=this.state$.getValue();this.getClasses(n.page,n.limit)})).subscribe()}updateState(c){if(c.page){const n=this.state$.getValue().limit;this.getClasses(c.page,n)}c.limit&&this.getClasses(1,c.limit)}}return Z.\u0275fac=function(c){return new(c||Z)(A.LFG(O.O))},Z.\u0275prov=A.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})()},7160:($,P,a)=>{a.d(P,{v:()=>Z});var e=a(1135),m=a(262),A=a(8505),O=a(5e3),S=a(4691);const g="climsoft/v1";let Z=(()=>{class d{constructor(n){this.http=n,this.stations$=new e.X({stations:[],limit:10,page:1,pages:1}),this.init=!1;const i=this.stations$.getValue();this.getStations(i.page,i.limit)}get stations(){return this.stations$.asObservable()}adapt(n){const i={station_name:"Station Name",wmoid:"WMO ID",icaoid:"ICAO ID",latitude:"Latitude",longitude:"Longitude",elevation:"Elevation",qualifier:"Qualifier",geolocation_method:"Geo Location Method",geolocation_accuracy:"Geo Location Accurary",opening_datetime:"Opening",closing_datetime:"Closing",country:"Country",authority:"Authority",admin_region:"Admin Region",drainage_basin:"Drainage",waca_selection:"WACA Selection",cpt_selection:"SCP SELECTION",station_operational:"Station Operational"};let t=[];return Object.keys(n).filter(r=>-1===["station_id","station_name"].indexOf(r)).forEach(r=>{const h={};switch(h.key=i[r],h.value=n[r]||"No Value",r){case"opening_datetime":case"closing_datetime":case"closing_datetime":h.type="date";break;default:h.type=null}t.push(h)}),t}updateState(n){if(n.page){const i=this.stations$.getValue().limit;this.getStations(n.page,i)}n.limit&&this.getStations(1,n.limit)}getStations(n,i){console.log(n,i),this.http.GET(`${g}/stations?limit=${i}&offset=${(n-1)*i}`).subscribe(r=>{console.log(r),this.stations$.next({stations:r.result,limit:i,page:r.page,pages:r.pages}),this.init=!0})}getStation(n){return this.http.GET(`${g}/stations/${n}`)}searchStation(n){return this.http.GET(`${g}/stations/search?query=${n}`)}addStation(n){return this.http.POST(`${g}/stations`,Object.assign(Object.assign({},n),{station_id:"2343403"})).pipe((0,m.K)(t=>{throw new Error(t.error.message)}),(0,A.b)(t=>{console.log(t);const r=this.stations$.getValue(),{page:h,limit:u}=r;this.getStations(h,u)}))}updateStation(n,i){return this.http.PUT(`${g}/stations/${n}`,i).pipe((0,m.K)(t=>{throw new Error(t.error.message)}),(0,A.b)(t=>{const r=this.stations$.getValue(),{page:h,limit:u}=r;this.getStations(h,u)}))}removeStation(n){this.http.DELETE(`${g}/stations/${n}`).pipe((0,m.K)(i=>{throw new Error(i.error.message)})).subscribe(i=>{const t=this.stations$.getValue(),{page:r,limit:h}=t;this.getStations(r,h)})}getStationElements(n){return this.http.GET(`${g}/stations/${n}/station-elements`)}addStationElement(n){return this.http.POST(`${g}/station-elements`,n)}updateStationElement(n,i){return this.http.PUT(`${g}/station-elements/${n.recorded_from}/${n.described_by}/${n.recoded_with}/${n.begin_date}`,i)}getStationLocHistory(n){return this.http.GET(`${g}/station-location-histories?belongs_to=${n}`)}addStationLocHistory(n){return this.http.POST(`${g}/station-location-histories`,n)}updateStationLocHistory(n,i,t){return this.http.PUT(`${g}/station-location-histories/${n}/${i}`,t)}getStationQualifiers(n){return this.http.GET(`${g}/station-qualifiers?belongs_to=${n}`)}}return d.\u0275fac=function(n){return new(n||d)(O.LFG(S.O))},d.\u0275prov=O.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},5683:($,P,a)=>{a.d(P,{J:()=>Z});var e=a(5e3),m=a(963),A=a(1728),O=a(9808);function S(d,c){if(1&d){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"li",12),e.TgZ(1,"a",3),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.oxw().pageChange(r)}),e._uU(2),e.qZA(),e.qZA()}if(2&d){const n=c.$implicit,i=e.oxw();e.Q6J("active",i.current===n),e.xp6(2),e.Oqu(n)}}function g(d,c){if(1&d){const n=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.oxw().onLimit(r)}),e._uU(1),e.qZA()}if(2&d){const n=c.$implicit,i=e.oxw();e.Q6J("active",n===i.limit),e.xp6(1),e.hij(" ",n," ")}}let Z=(()=>{class d{constructor(){this.limits=[10,20,30,50],this.limit=10,this.current=1,this.pages=[1],this.onPage=new e.vpe}ngOnInit(){}pageChange(n){"..."!==n&&(this.current=n,this.ngOnInit(),this.onPage.emit({page:n}))}onLimit(n){this.limit=n,this.onPage.emit({limit:n})}getPages(){if(this.pages.length<=10)return this.pages;var E,n=this.current,i=this.pages.length,r=n-2,h=n+2+1,u=[],y=[];for(let v=1;v<=i;v++)(1==v||v==i||v>=r&&v<h)&&u.push(v);for(let v of u)E&&(v-E==2?y.push(E+1):v-E!=1&&y.push("...")),y.push(v),E=v;return y}}return d.\u0275fac=function(n){return new(n||d)},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-paginator"]],inputs:{limits:"limits",limit:"limit",current:"current",pages:"pages"},outputs:{onPage:"onPage"},decls:19,vars:6,consts:[["xs","12","md","8","xl","5"],["aria-label","navigation","size","sm",1,"justify-content-center"],["cPageItem","",3,"disabled"],["cPageLink","",3,"click"],["cIcon","","name","cilMediaStepBackward"],["cIcon","","name","cilMediaSkipBackward"],["cPageItem","",3,"active",4,"ngFor","ngForOf"],["cIcon","","name","cilMediaSkipForward"],["cIcon","","name","cilMediaStepForward"],["xs","12","md","4","xl","7",1,"text-end"],["aria-label","Basic outlined example","role","group","size","sm"],["cButton","","color","primary","variant","outline",3,"active","click",4,"ngFor","ngForOf"],["cPageItem","",3,"active"],["cButton","","color","primary","variant","outline",3,"active","click"]],template:function(n,i){1&n&&(e.TgZ(0,"c-row"),e.TgZ(1,"c-col",0),e.TgZ(2,"c-pagination",1),e.TgZ(3,"li",2),e.TgZ(4,"a",3),e.NdJ("click",function(){return i.pageChange(1)}),e.O4$(),e._UZ(5,"svg",4),e.qZA(),e.qZA(),e.kcU(),e.TgZ(6,"li",2),e.TgZ(7,"a",3),e.NdJ("click",function(){return i.pageChange(i.current-1)}),e.O4$(),e._UZ(8,"svg",5),e.qZA(),e.qZA(),e.YNc(9,S,3,2,"li",6),e.kcU(),e.TgZ(10,"li",2),e.TgZ(11,"a",3),e.NdJ("click",function(){return i.pageChange(i.current+1)}),e.O4$(),e._UZ(12,"svg",7),e.qZA(),e.qZA(),e.kcU(),e.TgZ(13,"li",2),e.TgZ(14,"a",3),e.NdJ("click",function(){return i.pageChange(i.pages.length)}),e.O4$(),e._UZ(15,"svg",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(16,"c-col",9),e.TgZ(17,"c-button-group",10),e.YNc(18,g,2,2,"button",11),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Q6J("disabled",1===i.current),e.xp6(3),e.Q6J("disabled",1===i.current),e.xp6(3),e.Q6J("ngForOf",i.getPages()),e.xp6(1),e.Q6J("disabled",i.current===i.pages.length),e.xp6(3),e.Q6J("disabled",i.current===i.pages.length),e.xp6(5),e.Q6J("ngForOf",i.limits))},directives:[m.iok,m.Yp0,m.QtL,m.Qmh,m.YHm,A.ar,O.sg,m.KbJ,m.Hq3],styles:[".page-item[_ngcontent-%COMP%]{cursor:pointer}.page-item.disabled[_ngcontent-%COMP%]{cursor:not-allowed}"]}),d})()},1773:($,P,a)=>{a.d(P,{n:()=>v});var e=a(5e3),m=a(8306),A=a(8372),O=a(8505),S=a(3900),g=a(4004),Z=a(5032),d=a(262),c=a(9646),n=a(7160),i=a(3075),t=a(8184),r=a(9808);function h(C,M){1&C&&(e.TgZ(0,"div",4),e._UZ(1,"img",5),e._uU(2," searching..."),e.qZA())}function u(C,M){if(1&C&&(e.TgZ(0,"div",6),e.TgZ(1,"div",7),e._uU(2),e.qZA(),e.qZA()),2&C){const p=e.oxw();e.xp6(2),e.Oqu(p.errorMessage)}}function y(C,M){if(1&C&&(e.TgZ(0,"div",8),e._uU(1),e.qZA(),e.TgZ(2,"div",9),e._uU(3),e.qZA()),2&C){const p=M.item;e.xp6(1),e.AsE("",p.station_id," - ",p.station_name,""),e.xp6(2),e.hij(" ",p.element_name," ")}}const E=function(C){return{loading:C}};let v=(()=>{class C{constructor(p){this.stationService=p,this.placeholder="Station",this.onSelection=new e.vpe,this.typeaheadLoading=!1,this.typeaheadNoResults=!1,this.loading=!1,this.search="",this.errorMessage=""}ngOnInit(){this.stations$=new m.y(p=>{p.next(this.search)}).pipe((0,A.b)(400),(0,O.b)(()=>{this.errorMessage="",this.loading=!0}),(0,S.w)(p=>p?this.stationService.searchStation(p).pipe((0,O.b)(()=>{this.loading=!1}),(0,g.U)(f=>f.result||[]),(0,O.b)(()=>Z.Z,f=>{this.loading=!1,this.errorMessage=f&&f.message||"station search failed"}),(0,d.K)(f=>(this.errorMessage="station search failed",(0,c.of)(f)))):(0,c.of)([])))}changeTypeaheadLoading(p){this.typeaheadLoading=p}onSelect(p){this.selected=p.item,this.onSelection.emit(p.item)}}return C.\u0275fac=function(p){return new(p||C)(e.Y36(n.v))},C.\u0275cmp=e.Xpm({type:C,selectors:[["app-station-selection"]],inputs:{placeholder:"placeholder"},outputs:{onSelection:"onSelection"},decls:5,vars:11,consts:[["typeaheadOptionField","station_name","autocomplete","off","autocorrect","off",1,"form-control",3,"ngModel","typeahead","typeaheadAsync","typeaheadOptionsLimit","typeaheadItemTemplate","ngClass","placeholder","ngModelChange","typeaheadLoading","typeaheadOnSelect"],["class","typeahead-loading",4,"ngIf"],["ngClass","typeahead-error","class","typeahead-loading",4,"ngIf"],["itemTemplate",""],[1,"typeahead-loading"],["src","./assets/img/gif/spinner.gif","alt",""],["ngClass","typeahead-error",1,"typeahead-loading"],[1,"typeahead-error-inner"],[1,"item-heading"],[1,"item-title"]],template:function(p,f){if(1&p&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(b){return f.search=b})("typeaheadLoading",function(b){return f.changeTypeaheadLoading(b)})("typeaheadOnSelect",function(b){return f.onSelect(b)}),e.qZA(),e.YNc(1,h,3,0,"div",1),e.YNc(2,u,3,1,"div",2),e.YNc(3,y,4,3,"ng-template",null,3,e.W1O)),2&p){const I=e.MAs(4);e.Q6J("ngModel",f.search)("typeahead",f.stations$)("typeaheadAsync",!0)("typeaheadOptionsLimit",7)("typeaheadItemTemplate",I)("ngClass",e.VKq(9,E,f.typeaheadLoading))("placeholder",f.placeholder),e.xp6(1),e.Q6J("ngIf",f.loading),e.xp6(1),e.Q6J("ngIf",!f.loading&&f.errorMessage)}},directives:[i.Fj,i.JJ,i.On,t.Bp,r.mk,r.O5],styles:[".typeahead-loading[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.9rem}.typeahead-loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;margin-right:.2rem}typeahead-container[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%]{background-color:#277bc9!important}.item-heading[_ngcontent-%COMP%]{font-size:.7rem}.item-title[_ngcontent-%COMP%]{font-size:.9rem}.typeahead-error[_ngcontent-%COMP%]{margin-top:.2rem;padding:0 .3rem}.typeahead-error-inner[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.9rem;background-color:#ffd9d9;border:1px solid #c7a9a9;border-radius:.2rem;color:#d11a1a}"]}),C})()}}]);