"use strict";(self.webpackChunkclimsoft_app=self.webpackChunkclimsoft_app||[]).push([[867],{1076:(S,O,s)=>{s.r(O),s.d(O,{QualifierModule:()=>y});var e=s(6019),h=s(4333),C=s(1850),t=s(3668);let P=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-qualifier"]],decls:2,vars:0,template:function(a,u){1&a&&(t.TgZ(0,"p"),t._uU(1,"qualifier works!"),t.qZA())},styles:[""]}),o})();var p=s(2719),E=s(2997),_=s(4182),f=s(4437),n=s(7909),i=s(2606),c=s(8063),l=s(5261);function g(o,r){if(1&o){const a=t.EpF();t.TgZ(0,"tr"),t._uU(1,"\n            "),t.TgZ(2,"th",13),t._uU(3),t.qZA(),t._uU(4,"\n            "),t.TgZ(5,"td",10),t._uU(6),t.qZA(),t._uU(7,"\n            "),t.TgZ(8,"td",10),t._uU(9),t.qZA(),t._uU(10,"\n            "),t.TgZ(11,"td",10),t._uU(12),t.qZA(),t._uU(13,"\n            "),t.TgZ(14,"td",10),t._uU(15),t.ALo(16,"date"),t.qZA(),t._uU(17,"\n            "),t.TgZ(18,"td",10),t._uU(19),t.ALo(20,"date"),t.qZA(),t._uU(21,"\n            "),t.TgZ(22,"td"),t._uU(23,"\n              "),t.TgZ(24,"button",14),t.NdJ("click",function(){const U=t.CHM(a).$implicit;return t.oxw(2).view(U)}),t._uU(25,"\n                "),t.O4$(),t._UZ(26,"svg",15),t._uU(27,"\n              "),t.qZA(),t._uU(28,"\n              "),t.kcU(),t.TgZ(29,"button",16),t.NdJ("click",function(){const U=t.CHM(a).$implicit;return t.oxw(2).update(U)}),t._uU(30,"\n                "),t.O4$(),t._UZ(31,"svg",17),t._uU(32,"\n              "),t.qZA(),t._uU(33,"\n              "),t.kcU(),t.TgZ(34,"button",18),t.NdJ("click",function(){const U=t.CHM(a).$implicit;return t.oxw(2).remove(U)}),t._uU(35,"\n                "),t.O4$(),t._UZ(36,"svg",19),t._uU(37,"\n              "),t.qZA(),t._uU(38,"\n            "),t.qZA(),t._uU(39,"\n          "),t.qZA()}if(2&o){const a=r.$implicit;t.xp6(3),t.Oqu(a.belongs_to),t.xp6(3),t.Oqu(a.qualifier),t.xp6(3),t.Oqu(a.station_timezone),t.xp6(3),t.Oqu(a.station_network_type),t.xp6(3),t.Oqu(t.lcZ(16,6,a.qualifier_begin_date)),t.xp6(4),t.Oqu(t.lcZ(20,8,a.qualifier_end_date))}}function T(o,r){1&o&&(t.TgZ(0,"c-alert",20),t._uU(1," No qualifiers available to show. "),t.qZA())}function v(o,r){if(1&o){const a=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"c-card-body"),t._uU(1,"\n        "),t.TgZ(2,"app-paginator",8),t.NdJ("onPage",function(Z){return t.CHM(a),t.oxw().onPage(Z)}),t.qZA(),t._uU(3,"\n        "),t.TgZ(4,"table",9),t._uU(5,"\n          "),t.TgZ(6,"thead"),t._uU(7,"\n          "),t.TgZ(8,"tr"),t._uU(9,"\n            "),t.TgZ(10,"th",10),t._uU(11,"Station"),t.qZA(),t._uU(12,"\n            "),t.TgZ(13,"th",10),t._uU(14,"Qualifier"),t.qZA(),t._uU(15,"\n            "),t.TgZ(16,"th",10),t._uU(17,"Time Zone"),t.qZA(),t._uU(18,"\n            "),t.TgZ(19,"th",10),t._uU(20,"Network Type"),t.qZA(),t._uU(21,"\n            "),t.TgZ(22,"th",10),t._uU(23,"Opening"),t.qZA(),t._uU(24,"\n            "),t.TgZ(25,"th",10),t._uU(26,"Begin"),t.qZA(),t._uU(27,"\n            "),t.TgZ(28,"th",10),t._uU(29,"End"),t.qZA(),t._uU(30,"\n            "),t._UZ(31,"th"),t._uU(32,"\n          "),t.qZA(),t._uU(33,"\n          "),t.qZA(),t._uU(34,"\n          "),t.TgZ(35,"tbody"),t._uU(36,"\n          "),t.YNc(37,g,40,10,"tr",11),t._uU(38,"\n          "),t.qZA(),t._uU(39,"\n        "),t.qZA(),t._uU(40,"\n        "),t.YNc(41,T,2,0,"c-alert",12),t._uU(42,"\n      "),t.qZA()}if(2&o){const a=r.$implicit,u=t.oxw();t.xp6(2),t.Q6J("limit",a.limit)("current",a.page)("pages",u.createPages(a.pages)),t.xp6(35),t.Q6J("ngForOf",a.qualifiers),t.xp6(4),t.Q6J("ngIf",!a.qualifiers.length)}}const m=[{path:"",component:(()=>{class o{constructor(a,u){this.modalService=a,this.qualiferService=u,this.qualifiers$=(0,E.of)({qualifiers:[],limit:1,page:1,pages:1}),this.submitted=!1,this.loading=!1,this.error=!1,this.isUpdate=!1}ngOnInit(){this.qualifiers$=this.qualiferService.qualifiers}remove(a){this.modalService.show(p.S,{initialState:{title:"Qualifier Removal",message:"Operation cannot be undone. Are you sure you want to remove the qualifier record?",confirm:"Go Ahead",cancel:"Cancel"}}).content.onClose.subscribe(U=>{})}onPage(a){console.log(a),this.qualiferService.updateState(a)}createPages(a){return[...Array(a).keys()].map(u=>u+1)}addNew(){this.modalService.show(_.m,{initialState:{qualifier:void 0},class:"modal-lg",backdrop:"static",keyboard:!1}).content.onClose.subscribe(Z=>{Z&&this.qualiferService.addQualifier(Z).subscribe()})}update(a){this.modalService.show(_.m,{initialState:{qualifier:a},class:"modal-lg",backdrop:"static",keyboard:!1}).content.onClose.subscribe(U=>{U&&this.qualiferService.addQualifier(U).subscribe()})}view(a){}}return o.\u0275fac=function(a){return new(a||o)(t.Y36(f.tT),t.Y36(n.Q))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-qualifiers"]],decls:31,vars:3,consts:[["xs","12","lg","12","xl","12"],[1,"mb-4"],["xs","6"],[1,"col-6"],["xs","6",1,"text-end"],[1,"btn","btn-sm","cs-btn-sm","btn-outline",3,"click"],["cIcon","","name","cilPlus"],[4,"ngIf"],[3,"limit","current","pages","onPage"],["cTable",""],["scope","col"],[4,"ngFor","ngForOf"],["color","primary",4,"ngIf"],["scope","row"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","View Location History",3,"click"],["cIcon","","name","cilArrowThickFromLeft","size","sm"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Update Qualifier",3,"click"],["cIcon","","name","cilPencil","size","sm"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Remove Station",3,"click"],["cIcon","","name","cilTrash","size","sm",1,"text-danger"],["color","primary"]],template:function(a,u){1&a&&(t.TgZ(0,"c-row"),t._uU(1,"\n  "),t.TgZ(2,"c-col",0),t._uU(3,"\n    "),t.TgZ(4,"c-card",1),t._uU(5,"\n      "),t.TgZ(6,"c-card-header"),t._uU(7,"\n        "),t.TgZ(8,"c-row"),t._uU(9,"\n          "),t.TgZ(10,"c-col",2),t._uU(11,"\n            "),t.TgZ(12,"strong",3),t._uU(13,"Station Qualifiers"),t.qZA(),t._uU(14,"\n          "),t.qZA(),t._uU(15,"\n          "),t.TgZ(16,"c-col",4),t._uU(17,"\n            "),t.TgZ(18,"a",5),t.NdJ("click",function(){return u.addNew()}),t._uU(19," "),t.O4$(),t._UZ(20,"svg",6),t._uU(21," Add New "),t.qZA(),t._uU(22,"\n          "),t.qZA(),t._uU(23,"\n        "),t.qZA(),t._uU(24,"\n      "),t.qZA(),t._uU(25,"\n      "),t.YNc(26,v,43,5,"c-card-body",7),t.ALo(27,"async"),t._uU(28,"\n    "),t.qZA(),t._uU(29,"\n  "),t.qZA(),t._uU(30,"\n"),t.qZA()),2&a&&(t.xp6(26),t.Q6J("ngIf",t.lcZ(27,1,u.qualifiers$)))},directives:[i.iok,i.Yp0,i.AkF,i.nkx,c.ar,e.O5,i.yue,l.J,i.auY,e.sg,i.Hq3,i.i9q,i.wxo],pipes:[e.Ov,e.uU],styles:[""]}),o})(),data:{title:"Qualifiers"}},{path:":id",component:P,data:{title:"Qualidier"}}];let d=(()=>{class o{}return o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[C.Bz.forChild(m)],C.Bz]}),o})(),y=(()=>{class o{}return o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[e.ez,h.m,d]]}),o})()},9935:(S,O,s)=>{s.d(O,{v:()=>E});var e=s(4499),h=s(2835),C=s(7384),t=s(3668),P=s(453);const p="climsoft/v1";let E=(()=>{class _{constructor(n){this.http=n,this.stations$=new e.X({stations:[],limit:10,page:1,pages:1}),this.init=!1;const i=this.stations$.getValue();this.getStations(i.page,i.limit)}get stations(){return this.stations$.asObservable()}adapt(n){const i={station_name:"Station Name",wmoid:"WMO ID",icaoid:"ICAO ID",latitude:"Latitude",longitude:"Longitude",elevation:"Elevation",qualifier:"Qualifier",geolocation_method:"Geo Location Method",geolocation_accuracy:"Geo Location Accurary",opening_datetime:"Opening",closing_datetime:"Closing",country:"Country",authority:"Authority",admin_region:"Admin Region",drainage_basin:"Drainage",waca_selection:"WACA Selection",cpt_selection:"SCP SELECTION",station_operational:"Station Operational"};let c=[];return Object.keys(n).filter(l=>-1===["station_id","station_name"].indexOf(l)).forEach(l=>{const g={};switch(g.key=i[l],g.value=n[l]||"No Value",l){case"opening_datetime":case"closing_datetime":case"closing_datetime":g.type="date";break;default:g.type=null}c.push(g)}),c}updateState(n){if(n.page){const i=this.stations$.getValue().limit;this.getStations(n.page,i)}n.limit&&this.getStations(1,n.limit)}getStations(n,i){console.log(n,i),this.http.GET(`${p}/stations?limit=${i}&offset=${(n-1)*i}`).subscribe(l=>{console.log(l),this.stations$.next({stations:l.result,limit:i,page:l.page,pages:l.pages}),this.init=!0})}getStation(n){return this.http.GET(`${p}/stations/${n}`)}searchStation(n){return this.http.GET(`${p}/stations/search?query=${n}`)}addStation(n){return this.http.POST(`${p}/stations`,Object.assign(Object.assign({},n),{station_id:"2343403"})).pipe((0,h.K)(c=>{throw new Error(c.error.message)}),(0,C.b)(c=>{console.log(c);const l=this.stations$.getValue(),{page:g,limit:T}=l;this.getStations(g,T)}))}updateStation(n,i){return this.http.PUT(`${p}/stations/${n}`,i).pipe((0,h.K)(c=>{throw new Error(c.error.message)}),(0,C.b)(c=>{const l=this.stations$.getValue(),{page:g,limit:T}=l;this.getStations(g,T)}))}removeStation(n){this.http.DELETE(`${p}/stations/${n}`).pipe((0,h.K)(i=>{throw new Error(i.error.message)})).subscribe(i=>{const c=this.stations$.getValue(),{page:l,limit:g}=c;this.getStations(l,g)})}getStationElements(n){return this.http.GET(`${p}/stations/${n}/station-elements`)}addStationElement(n){return this.http.POST(`${p}/station-elements`,n)}updateStationElement(n,i){return this.http.PUT(`${p}/station-elements/${n.recorded_from}/${n.described_by}/${n.recoded_with}/${n.begin_date}`,i)}getStationLocHistory(n){return this.http.GET(`${p}/station-location-histories?belongs_to=${n}`)}addStationLocHistory(n){return this.http.POST(`${p}/station-location-histories`,n)}updateStationLocHistory(n,i,c){return this.http.PUT(`${p}/station-location-histories/${n}/${i}`,c)}getStationQualifiers(n){return this.http.GET(`${p}/station-qualifiers?belongs_to=${n}`)}}return _.\u0275fac=function(n){return new(n||_)(t.LFG(P.O))},_.\u0275prov=t.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5261:(S,O,s)=>{s.d(O,{J:()=>E});var e=s(3668),h=s(2606),C=s(8063),t=s(6019);function P(_,f){if(1&_){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"li",12),e.TgZ(1,"a",3),e.NdJ("click",function(){const l=e.CHM(n).$implicit;return e.oxw().pageChange(l)}),e._uU(2),e.qZA(),e.qZA()}if(2&_){const n=f.$implicit,i=e.oxw();e.Q6J("active",i.current===n),e.xp6(2),e.Oqu(n)}}function p(_,f){if(1&_){const n=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){const l=e.CHM(n).$implicit;return e.oxw().onLimit(l)}),e._uU(1),e.qZA()}if(2&_){const n=f.$implicit,i=e.oxw();e.Q6J("active",n===i.limit),e.xp6(1),e.hij(" ",n," ")}}let E=(()=>{class _{constructor(){this.limits=[10,20,30,50],this.limit=10,this.current=1,this.pages=[1],this.onPage=new e.vpe}ngOnInit(){}pageChange(n){"..."!==n&&(this.current=n,this.ngOnInit(),this.onPage.emit({page:n}))}onLimit(n){this.limit=n,this.onPage.emit({limit:n})}getPages(){if(this.pages.length<=10)return this.pages;var A,n=this.current,i=this.pages.length,l=n-2,g=n+2+1,T=[],v=[];for(let m=1;m<=i;m++)(1==m||m==i||m>=l&&m<g)&&T.push(m);for(let m of T)A&&(m-A==2?v.push(A+1):m-A!=1&&v.push("...")),v.push(m),A=m;return v}}return _.\u0275fac=function(n){return new(n||_)},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-paginator"]],inputs:{limits:"limits",limit:"limit",current:"current",pages:"pages"},outputs:{onPage:"onPage"},decls:19,vars:6,consts:[["xs","12","md","8","xl","5"],["aria-label","navigation","size","sm",1,"justify-content-center"],["cPageItem","",3,"disabled"],["cPageLink","",3,"click"],["cIcon","","name","cilMediaStepBackward"],["cIcon","","name","cilMediaSkipBackward"],["cPageItem","",3,"active",4,"ngFor","ngForOf"],["cIcon","","name","cilMediaSkipForward"],["cIcon","","name","cilMediaStepForward"],["xs","12","md","4","xl","7",1,"text-end"],["aria-label","Basic outlined example","role","group","size","sm"],["cButton","","color","primary","variant","outline",3,"active","click",4,"ngFor","ngForOf"],["cPageItem","",3,"active"],["cButton","","color","primary","variant","outline",3,"active","click"]],template:function(n,i){1&n&&(e.TgZ(0,"c-row"),e.TgZ(1,"c-col",0),e.TgZ(2,"c-pagination",1),e.TgZ(3,"li",2),e.TgZ(4,"a",3),e.NdJ("click",function(){return i.pageChange(1)}),e.O4$(),e._UZ(5,"svg",4),e.qZA(),e.qZA(),e.kcU(),e.TgZ(6,"li",2),e.TgZ(7,"a",3),e.NdJ("click",function(){return i.pageChange(i.current-1)}),e.O4$(),e._UZ(8,"svg",5),e.qZA(),e.qZA(),e.YNc(9,P,3,2,"li",6),e.kcU(),e.TgZ(10,"li",2),e.TgZ(11,"a",3),e.NdJ("click",function(){return i.pageChange(i.current+1)}),e.O4$(),e._UZ(12,"svg",7),e.qZA(),e.qZA(),e.kcU(),e.TgZ(13,"li",2),e.TgZ(14,"a",3),e.NdJ("click",function(){return i.pageChange(i.pages.length)}),e.O4$(),e._UZ(15,"svg",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(16,"c-col",9),e.TgZ(17,"c-button-group",10),e.YNc(18,p,2,2,"button",11),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Q6J("disabled",1===i.current),e.xp6(3),e.Q6J("disabled",1===i.current),e.xp6(3),e.Q6J("ngForOf",i.getPages()),e.xp6(1),e.Q6J("disabled",i.current===i.pages.length),e.xp6(3),e.Q6J("disabled",i.current===i.pages.length),e.xp6(5),e.Q6J("ngForOf",i.limits))},directives:[h.iok,h.Yp0,h.QtL,h.Qmh,h.YHm,C.ar,t.sg,h.KbJ,h.Hq3],styles:[".page-item[_ngcontent-%COMP%]{cursor:pointer}.page-item.disabled[_ngcontent-%COMP%]{cursor:not-allowed}"]}),_})()},5154:(S,O,s)=>{s.d(O,{n:()=>m});var e=s(3668),h=s(8305),C=s(9463),t=s(7384),P=s(3067),p=s(4753),E=s(6921),_=s(2835),f=s(2997),n=s(9935),i=s(9133),c=s(9097),l=s(6019);function g(d,y){1&d&&(e.TgZ(0,"div",4),e._UZ(1,"img",5),e._uU(2," searching..."),e.qZA())}function T(d,y){if(1&d&&(e.TgZ(0,"div",6),e.TgZ(1,"div",7),e._uU(2),e.qZA(),e.qZA()),2&d){const o=e.oxw();e.xp6(2),e.Oqu(o.errorMessage)}}function v(d,y){if(1&d&&(e.TgZ(0,"div",8),e._uU(1),e.qZA(),e.TgZ(2,"div",9),e._uU(3),e.qZA()),2&d){const o=y.item;e.xp6(1),e.AsE("",o.station_id," - ",o.station_name,""),e.xp6(2),e.hij(" ",o.element_name," ")}}const A=function(d){return{loading:d}};let m=(()=>{class d{constructor(o){this.stationService=o,this.placeholder="Station",this.onSelection=new e.vpe,this.typeaheadLoading=!1,this.typeaheadNoResults=!1,this.loading=!1,this.search="",this.errorMessage=""}ngOnInit(){this.stations$=new h.y(o=>{o.next(this.search)}).pipe((0,C.b)(400),(0,t.b)(()=>{this.errorMessage="",this.loading=!0}),(0,P.w)(o=>o?this.stationService.searchStation(o).pipe((0,t.b)(()=>{this.loading=!1}),(0,p.U)(r=>r.result||[]),(0,t.b)(()=>E.Z,r=>{this.loading=!1,this.errorMessage=r&&r.message||"station search failed"}),(0,_.K)(r=>(this.errorMessage="station search failed",(0,f.of)(r)))):(0,f.of)([])))}changeTypeaheadLoading(o){this.typeaheadLoading=o}onSelect(o){this.selected=o.item,this.onSelection.emit(o.item)}}return d.\u0275fac=function(o){return new(o||d)(e.Y36(n.v))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-station-selection"]],inputs:{placeholder:"placeholder"},outputs:{onSelection:"onSelection"},decls:5,vars:11,consts:[["typeaheadOptionField","station_name","autocomplete","off","autocorrect","off",1,"form-control",3,"ngModel","typeahead","typeaheadAsync","typeaheadOptionsLimit","typeaheadItemTemplate","ngClass","placeholder","ngModelChange","typeaheadLoading","typeaheadOnSelect"],["class","typeahead-loading",4,"ngIf"],["ngClass","typeahead-error","class","typeahead-loading",4,"ngIf"],["itemTemplate",""],[1,"typeahead-loading"],["src","./assets/img/gif/spinner.gif","alt",""],["ngClass","typeahead-error",1,"typeahead-loading"],[1,"typeahead-error-inner"],[1,"item-heading"],[1,"item-title"]],template:function(o,r){if(1&o&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(u){return r.search=u})("typeaheadLoading",function(u){return r.changeTypeaheadLoading(u)})("typeaheadOnSelect",function(u){return r.onSelect(u)}),e.qZA(),e.YNc(1,g,3,0,"div",1),e.YNc(2,T,3,1,"div",2),e.YNc(3,v,4,3,"ng-template",null,3,e.W1O)),2&o){const a=e.MAs(4);e.Q6J("ngModel",r.search)("typeahead",r.stations$)("typeaheadAsync",!0)("typeaheadOptionsLimit",7)("typeaheadItemTemplate",a)("ngClass",e.VKq(9,A,r.typeaheadLoading))("placeholder",r.placeholder),e.xp6(1),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading&&r.errorMessage)}},directives:[i.Fj,i.JJ,i.On,c.Bp,l.mk,l.O5],styles:[".typeahead-loading[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.9rem}.typeahead-loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;margin-right:.2rem}typeahead-container[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%]{background-color:#277bc9!important}.item-heading[_ngcontent-%COMP%]{font-size:.7rem}.item-title[_ngcontent-%COMP%]{font-size:.9rem}.typeahead-error[_ngcontent-%COMP%]{margin-top:.2rem;padding:0 .3rem}.typeahead-error-inner[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.9rem;background-color:#ffd9d9;border:1px solid #c7a9a9;border-radius:.2rem;color:#d11a1a}"]}),d})()}}]);