"use strict";(self.webpackChunkclimsoft_app=self.webpackChunkclimsoft_app||[]).push([[50],{9935:(x,C,a)=>{a.d(C,{v:()=>e});var t=a(4499),h=a(2835),P=a(7384),f=a(3668),M=a(453);const m="climsoft/v1";let e=(()=>{class _{constructor(n){this.http=n,this.stations$=new t.X({stations:[],limit:10,page:1,pages:1}),this.init=!1;const o=this.stations$.getValue();this.getStations(o.page,o.limit)}get stations(){return this.stations$.asObservable()}adapt(n){const o={station_name:"Station Name",wmoid:"WMO ID",icaoid:"ICAO ID",latitude:"Latitude",longitude:"Longitude",elevation:"Elevation",qualifier:"Qualifier",geolocation_method:"Geo Location Method",geolocation_accuracy:"Geo Location Accurary",opening_datetime:"Opening",closing_datetime:"Closing",country:"Country",authority:"Authority",admin_region:"Admin Region",drainage_basin:"Drainage",waca_selection:"WACA Selection",cpt_selection:"SCP SELECTION",station_operational:"Station Operational"};let l=[];return Object.keys(n).filter(c=>-1===["station_id","station_name"].indexOf(c)).forEach(c=>{const p={};switch(p.key=o[c],p.value=n[c]||"No Value",c){case"opening_datetime":case"closing_datetime":case"closing_datetime":p.type="date";break;default:p.type=null}l.push(p)}),l}updateState(n){if(n.page){const o=this.stations$.getValue().limit;this.getStations(n.page,o)}n.limit&&this.getStations(1,n.limit)}getStations(n,o){console.log(n,o),this.http.GET(`${m}/stations?limit=${o}&offset=${(n-1)*o}`).subscribe(c=>{console.log(c),this.stations$.next({stations:c.result,limit:o,page:c.page,pages:c.pages}),this.init=!0})}getStation(n){return this.http.GET(`${m}/stations/${n}`)}searchStation(n){return this.http.GET(`${m}/stations/search?query=${n}`)}addStation(n){return this.http.POST(`${m}/stations`,Object.assign(Object.assign({},n),{station_id:"2343403"})).pipe((0,h.K)(l=>{throw new Error(l.error.message)}),(0,P.b)(l=>{console.log(l);const c=this.stations$.getValue(),{page:p,limit:O}=c;this.getStations(p,O)}))}updateStation(n,o){return this.http.PUT(`${m}/stations/${n}`,o).pipe((0,h.K)(l=>{throw new Error(l.error.message)}),(0,P.b)(l=>{const c=this.stations$.getValue(),{page:p,limit:O}=c;this.getStations(p,O)}))}removeStation(n){this.http.DELETE(`${m}/stations/${n}`).pipe((0,h.K)(o=>{throw new Error(o.error.message)})).subscribe(o=>{const l=this.stations$.getValue(),{page:c,limit:p}=l;this.getStations(c,p)})}getStationElements(n){return this.http.GET(`${m}/stations/${n}/station-elements`)}addStationElement(n){return this.http.POST(`${m}/station-elements`,n)}updateStationElement(n,o){return this.http.PUT(`${m}/station-elements/${n.recorded_from}/${n.described_by}/${n.recoded_with}/${n.begin_date}`,o)}getStationLocHistory(n){return this.http.GET(`${m}/station-location-histories?belongs_to=${n}`)}addStationLocHistory(n){return this.http.POST(`${m}/station-location-histories`,n)}updateStationLocHistory(n,o,l){return this.http.PUT(`${m}/station-location-histories/${n}/${o}`,l)}getStationQualifiers(n){return this.http.GET(`${m}/station-qualifiers?belongs_to=${n}`)}}return _.\u0275fac=function(n){return new(n||_)(f.LFG(M.O))},_.\u0275prov=f.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},576:(x,C,a)=>{a.d(C,{$:()=>E});var t=a(4522),h=a(7384),P=a(461),f=a(4753),M=a(2835),m=a(9433),e=a(3668),_=a(453),u=a(6019),n=a(2606),o=a(8442),l=a(8063);function c(r,g){if(1&r){const i=e.EpF();e.TgZ(0,"c-row",3),e.TgZ(1,"c-col",4),e.TgZ(2,"ngx-dropzone",5),e.NdJ("change",function(d){return e.CHM(i),e.oxw().onSelect(d)}),e.TgZ(3,"ngx-dropzone-label",6),e._uU(4,"Click or Drop Image "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const i=e.oxw();e.xp6(2),e.ekj("dropzone-visible",!i.files.length),e.Q6J("multiple",!1)}}function p(r,g){if(1&r&&(e.TgZ(0,"c-row"),e.TgZ(1,"c-col",7),e.TgZ(2,"c-progress",8),e.TgZ(3,"c-progress-bar",9),e._uU(4),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r){const i=e.oxw();e.xp6(3),e.Q6J("value",i.progress),e.xp6(1),e.hij("",i.progress,"%")}}function O(r,g){if(1&r&&(e.TgZ(0,"ngx-dropzone-image-preview",15),e.TgZ(1,"ngx-dropzone-label"),e._uU(2),e.qZA(),e.qZA()),2&r){const i=g.$implicit;e.Q6J("file",i),e.xp6(2),e.Oqu(i.name)}}function T(r,g){if(1&r){const i=e.EpF();e.TgZ(0,"c-row",10),e.TgZ(1,"c-col",4),e.YNc(2,O,3,2,"ngx-dropzone-image-preview",11),e.qZA(),e.TgZ(3,"c-col",12),e.TgZ(4,"button",13),e.NdJ("click",function(d){return e.CHM(i),e.oxw().onRemove(d)}),e.O4$(),e._UZ(5,"svg",14),e._uU(6," Remove "),e.qZA(),e.qZA(),e.qZA()}if(2&r){const i=e.oxw();e.xp6(2),e.Q6J("ngForOf",i.files)}}let E=(()=>{class r{constructor(i,s){this.ref=i,this.http=s,this.files=[],this.loading=!1}ngOnInit(){}upload(){if(this.files.length)return this.loading=!0,this.http.UPLOAD_TO_S3(this.files[0],this.feature).pipe((0,h.b)(i=>{switch(console.log(i),i.type){case t.dt.UploadProgress:i&&i.total&&(this.progress=Math.round(i.loaded/i.total*100),console.log(`Uploaded! ${this.progress}%`));break;case t.dt.Response:setTimeout(()=>{this.progress=0,this.loading=!1},1e3)}}),(0,P.h)(i=>i.type===t.dt.Response),(0,f.U)(i=>i.body),(0,M.K)(this.errorMgmt))}onSelect(i){this.files.push(i.addedFiles[0]),console.log(this.files)}onRemove(i){console.log(i),this.files.splice(this.files.indexOf(i),1)}resetMedia(i){}errorMgmt(i){let s="";return s=i.error instanceof ErrorEvent?i.error.message:`Error Code: ${i.status}\nMessage: ${i.message}`,console.log(s),(0,m._)(()=>s)}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(e.sBO),e.Y36(_.O))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-image-uploader"]],inputs:{feature:"feature"},decls:3,vars:3,consts:[["class","dropzone-container",4,"ngIf"],[4,"ngIf"],["class","preview-container",4,"ngIf"],[1,"dropzone-container"],["md","12"],["accept","image/jpeg,image/jpg,image/png,image/gif",3,"multiple","change"],[2,"line-height","20px"],["md","12","lg","8",1,"px-3"],[1,"mb-3"],["color","info",3,"value"],[1,"preview-container"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file",4,"ngFor","ngForOf"],["md","12",1,"text-end"],["type","button","cButton","","size","sm","variant","ghost","color","danger",3,"click"],["cIcon","","name","cilX"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file"]],template:function(i,s){1&i&&(e.YNc(0,c,5,3,"c-row",0),e.YNc(1,p,5,2,"c-row",1),e.YNc(2,T,7,1,"c-row",2)),2&i&&(e.Q6J("ngIf",!s.files.length),e.xp6(1),e.Q6J("ngIf",s.files.length&&s.loading),e.xp6(1),e.Q6J("ngIf",s.files.length&&!s.loading))},directives:[u.O5,n.iok,n.Yp0,o._f,o.NP,n.t15,n.RIQ,u.sg,n.Hq3,l.ar,o.sv],styles:["ngx-dropzone[_ngcontent-%COMP%]{height:180px;background:#333;color:#fff;border:2px dashed #eb4f4f;border-radius:1rem;font-size:1.5ren}ngx-dropzone-image-preview[_ngcontent-%COMP%]{border:2px dashed #92c770;padding-top:30px!important;padding-bottom:10px!important;height:200px!important}ngx-dropzone-label[_ngcontent-%COMP%]{top:0;padding:5px 0;font-size:.8rem}"]}),r})()},5261:(x,C,a)=>{a.d(C,{J:()=>e});var t=a(3668),h=a(2606),P=a(8063),f=a(6019);function M(_,u){if(1&_){const n=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"li",12),t.TgZ(1,"a",3),t.NdJ("click",function(){const c=t.CHM(n).$implicit;return t.oxw().pageChange(c)}),t._uU(2),t.qZA(),t.qZA()}if(2&_){const n=u.$implicit,o=t.oxw();t.Q6J("active",o.current===n),t.xp6(2),t.Oqu(n)}}function m(_,u){if(1&_){const n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){const c=t.CHM(n).$implicit;return t.oxw().onLimit(c)}),t._uU(1),t.qZA()}if(2&_){const n=u.$implicit,o=t.oxw();t.Q6J("active",n===o.limit),t.xp6(1),t.hij(" ",n," ")}}let e=(()=>{class _{constructor(){this.limits=[10,20,30,50],this.limit=10,this.current=1,this.pages=[1],this.onPage=new t.vpe}ngOnInit(){}pageChange(n){"..."!==n&&(this.current=n,this.ngOnInit(),this.onPage.emit({page:n}))}onLimit(n){this.limit=n,this.onPage.emit({limit:n})}getPages(){if(this.pages.length<=10)return this.pages;var E,n=this.current,o=this.pages.length,c=n-2,p=n+2+1,O=[],T=[];for(let r=1;r<=o;r++)(1==r||r==o||r>=c&&r<p)&&O.push(r);for(let r of O)E&&(r-E==2?T.push(E+1):r-E!=1&&T.push("...")),T.push(r),E=r;return T}}return _.\u0275fac=function(n){return new(n||_)},_.\u0275cmp=t.Xpm({type:_,selectors:[["app-paginator"]],inputs:{limits:"limits",limit:"limit",current:"current",pages:"pages"},outputs:{onPage:"onPage"},decls:19,vars:6,consts:[["xs","12","md","8","xl","5"],["aria-label","navigation","size","sm",1,"justify-content-center"],["cPageItem","",3,"disabled"],["cPageLink","",3,"click"],["cIcon","","name","cilMediaStepBackward"],["cIcon","","name","cilMediaSkipBackward"],["cPageItem","",3,"active",4,"ngFor","ngForOf"],["cIcon","","name","cilMediaSkipForward"],["cIcon","","name","cilMediaStepForward"],["xs","12","md","4","xl","7",1,"text-end"],["aria-label","Basic outlined example","role","group","size","sm"],["cButton","","color","primary","variant","outline",3,"active","click",4,"ngFor","ngForOf"],["cPageItem","",3,"active"],["cButton","","color","primary","variant","outline",3,"active","click"]],template:function(n,o){1&n&&(t.TgZ(0,"c-row"),t.TgZ(1,"c-col",0),t.TgZ(2,"c-pagination",1),t.TgZ(3,"li",2),t.TgZ(4,"a",3),t.NdJ("click",function(){return o.pageChange(1)}),t.O4$(),t._UZ(5,"svg",4),t.qZA(),t.qZA(),t.kcU(),t.TgZ(6,"li",2),t.TgZ(7,"a",3),t.NdJ("click",function(){return o.pageChange(o.current-1)}),t.O4$(),t._UZ(8,"svg",5),t.qZA(),t.qZA(),t.YNc(9,M,3,2,"li",6),t.kcU(),t.TgZ(10,"li",2),t.TgZ(11,"a",3),t.NdJ("click",function(){return o.pageChange(o.current+1)}),t.O4$(),t._UZ(12,"svg",7),t.qZA(),t.qZA(),t.kcU(),t.TgZ(13,"li",2),t.TgZ(14,"a",3),t.NdJ("click",function(){return o.pageChange(o.pages.length)}),t.O4$(),t._UZ(15,"svg",8),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.kcU(),t.TgZ(16,"c-col",9),t.TgZ(17,"c-button-group",10),t.YNc(18,m,2,2,"button",11),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("disabled",1===o.current),t.xp6(3),t.Q6J("disabled",1===o.current),t.xp6(3),t.Q6J("ngForOf",o.getPages()),t.xp6(1),t.Q6J("disabled",o.current===o.pages.length),t.xp6(3),t.Q6J("disabled",o.current===o.pages.length),t.xp6(5),t.Q6J("ngForOf",o.limits))},directives:[h.iok,h.Yp0,h.QtL,h.Qmh,h.YHm,P.ar,f.sg,h.KbJ,h.Hq3],styles:[".page-item[_ngcontent-%COMP%]{cursor:pointer}.page-item.disabled[_ngcontent-%COMP%]{cursor:not-allowed}"]}),_})()},5154:(x,C,a)=>{a.d(C,{n:()=>r});var t=a(3668),h=a(8305),P=a(9463),f=a(7384),M=a(3067),m=a(4753),e=a(6921),_=a(2835),u=a(2997),n=a(9935),o=a(9133),l=a(9097),c=a(6019);function p(g,i){1&g&&(t.TgZ(0,"div",4),t._UZ(1,"img",5),t._uU(2," searching..."),t.qZA())}function O(g,i){if(1&g&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t._uU(2),t.qZA(),t.qZA()),2&g){const s=t.oxw();t.xp6(2),t.Oqu(s.errorMessage)}}function T(g,i){if(1&g&&(t.TgZ(0,"div",8),t._uU(1),t.qZA(),t.TgZ(2,"div",9),t._uU(3),t.qZA()),2&g){const s=i.item;t.xp6(1),t.AsE("",s.station_id," - ",s.station_name,""),t.xp6(2),t.hij(" ",s.element_name," ")}}const E=function(g){return{loading:g}};let r=(()=>{class g{constructor(s){this.stationService=s,this.placeholder="Station",this.onSelection=new t.vpe,this.typeaheadLoading=!1,this.typeaheadNoResults=!1,this.loading=!1,this.search="",this.errorMessage=""}ngOnInit(){this.stations$=new h.y(s=>{s.next(this.search)}).pipe((0,P.b)(400),(0,f.b)(()=>{this.errorMessage="",this.loading=!0}),(0,M.w)(s=>s?this.stationService.searchStation(s).pipe((0,f.b)(()=>{this.loading=!1}),(0,m.U)(d=>d.result||[]),(0,f.b)(()=>e.Z,d=>{this.loading=!1,this.errorMessage=d&&d.message||"station search failed"}),(0,_.K)(d=>(this.errorMessage="station search failed",(0,u.of)(d)))):(0,u.of)([])))}changeTypeaheadLoading(s){this.typeaheadLoading=s}onSelect(s){this.selected=s.item,this.onSelection.emit(s.item)}}return g.\u0275fac=function(s){return new(s||g)(t.Y36(n.v))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-station-selection"]],inputs:{placeholder:"placeholder"},outputs:{onSelection:"onSelection"},decls:5,vars:11,consts:[["typeaheadOptionField","station_name","autocomplete","off","autocorrect","off",1,"form-control",3,"ngModel","typeahead","typeaheadAsync","typeaheadOptionsLimit","typeaheadItemTemplate","ngClass","placeholder","ngModelChange","typeaheadLoading","typeaheadOnSelect"],["class","typeahead-loading",4,"ngIf"],["ngClass","typeahead-error","class","typeahead-loading",4,"ngIf"],["itemTemplate",""],[1,"typeahead-loading"],["src","./assets/img/gif/spinner.gif","alt",""],["ngClass","typeahead-error",1,"typeahead-loading"],[1,"typeahead-error-inner"],[1,"item-heading"],[1,"item-title"]],template:function(s,d){if(1&s&&(t.TgZ(0,"input",0),t.NdJ("ngModelChange",function(A){return d.search=A})("typeaheadLoading",function(A){return d.changeTypeaheadLoading(A)})("typeaheadOnSelect",function(A){return d.onSelect(A)}),t.qZA(),t.YNc(1,p,3,0,"div",1),t.YNc(2,O,3,1,"div",2),t.YNc(3,T,4,3,"ng-template",null,3,t.W1O)),2&s){const v=t.MAs(4);t.Q6J("ngModel",d.search)("typeahead",d.stations$)("typeaheadAsync",!0)("typeaheadOptionsLimit",7)("typeaheadItemTemplate",v)("ngClass",t.VKq(9,E,d.typeaheadLoading))("placeholder",d.placeholder),t.xp6(1),t.Q6J("ngIf",d.loading),t.xp6(1),t.Q6J("ngIf",!d.loading&&d.errorMessage)}},directives:[o.Fj,o.JJ,o.On,l.Bp,c.mk,c.O5],styles:[".typeahead-loading[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.9rem}.typeahead-loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;margin-right:.2rem}typeahead-container[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%]{background-color:#277bc9!important}.item-heading[_ngcontent-%COMP%]{font-size:.7rem}.item-title[_ngcontent-%COMP%]{font-size:.9rem}.typeahead-error[_ngcontent-%COMP%]{margin-top:.2rem;padding:0 .3rem}.typeahead-error-inner[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.9rem;background-color:#ffd9d9;border:1px solid #c7a9a9;border-radius:.2rem;color:#d11a1a}"]}),g})()}}]);