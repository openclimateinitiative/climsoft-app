"use strict";(self.webpackChunkclimsoft_app=self.webpackChunkclimsoft_app||[]).push([[439],{7777:(C,I,r)=>{r.d(I,{C:()=>f});var s=r(3668);let f=(()=>{class d{constructor(){this.unSaved=!0}canDeactivate(t){return!t.canExit||t.canExit()}}return d.\u0275fac=function(t){return new(t||d)},d.\u0275prov=s.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},2439:(C,I,r)=>{r.r(I),r.d(I,{InstrumentModule:()=>At});var s=r(4333),f=r(6019),d=r(1850),h=r(7777),t=r(3668);let v=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-instrument"]],decls:2,vars:0,template:function(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"instrument works!"),t.qZA())},styles:[""]}),e})();var l=r(9133),T=r(4753),A=r(2997),a=r(7384),_=r(461),m=r(3067),g=r(2098),u=r(2835),U=r(9463),x=r(9468),q=r(2070),O=r(9844),N=r(9935),p=r(2606),w=r(2409),E=r(576),M=r(4379),y=r(8063),J=r(5154);const Y=["imageUploader"];function S(e,o){1&e&&(t.TgZ(0,"c-alert",38),t.TgZ(1,"strong"),t._uU(2,"Error(s)"),t.qZA(),t._uU(3," Please correct the following erros before you proceed."),t.qZA())}function Q(e,o){1&e&&(t.TgZ(0,"c-row"),t._uU(1,"\n            "),t.TgZ(2,"c-col",39),t._uU(3,"\n              "),t._UZ(4,"app-infinite-loading"),t._uU(5,"\n            "),t.qZA(),t._uU(6,"\n          "),t.qZA())}function P(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Instrument is required."),t.qZA())}function $(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Instrument id already exists."),t.qZA())}function L(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,P,4,0,"div",4),t._uU(3,"\n                  "),t.YNc(4,$,4,0,"div",4),t._uU(5,"\n                "),t.qZA()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("ngIf",n.f.instrument_id.errors.required),t.xp6(2),t.Q6J("ngIf",n.instValidated&&n.f.instrument_id.hasError("instrumentExists"))}}const V=function(e,o){return{"is-invalid":e,"is-valid":o}};function K(e,o){if(1&e&&(t.TgZ(0,"c-row"),t._uU(1,"\n            "),t.TgZ(2,"c-col",5),t._uU(3,"\n              "),t.TgZ(4,"div",40),t._uU(5,"\n                "),t.TgZ(6,"label",41),t._uU(7,"Instrument ID"),t.qZA(),t._uU(8,"\n                "),t._UZ(9,"input",42),t._uU(10,"\n                "),t.YNc(11,L,6,2,"div",9),t._uU(12,"\n              "),t.qZA(),t._uU(13,"\n            "),t.qZA(),t._uU(14,"\n          "),t.qZA()),2&e){const n=t.oxw();t.xp6(9),t.Tol(n.instValidated&&n.f.instrument_id.hasError("instrumentExists")?"is-invalid":""),t.Q6J("ngClass",t.WLB(5,V,n.f.instrument_id.touched&&n.f.instrument_id.invalid,n.instValidated&&!n.f.instrument_id.hasError("instrumentExists"))),t.xp6(2),t.Q6J("ngIf",n.f.instrument_id.errors)}}function B(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Instrument name is required."),t.qZA())}function R(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,B,4,0,"div",4),t._uU(3,"\n                "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.instrument_name.errors.required)}}function k(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Latitude is required."),t.qZA())}function H(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Latitude must be a number."),t.qZA())}function W(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,k,4,0,"div",4),t._uU(3,"\n                  "),t.YNc(4,H,4,0,"div",4),t._uU(5,"\n                "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.abbreviation.errors.required),t.xp6(2),t.Q6J("ngIf",n.f.abbreviation.errors.pattern)}}function z(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," WMO Id is required."),t.qZA())}function G(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,z,4,0,"div",4),t._uU(3,"\n                "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.manufacturer.errors.required)}}function j(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Elevation is required."),t.qZA())}function X(e,o){if(1&e&&(t.TgZ(0,"div",45),t._uU(1,"\n                    "),t.YNc(2,j,4,0,"div",4),t._uU(3,"\n                  "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.model.errors.required)}}function tt(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Serial Number is required."),t.qZA())}function nt(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Value must be a number."),t.qZA())}function et(e,o){if(1&e&&(t.TgZ(0,"div",45),t._uU(1,"\n                    "),t.YNc(2,tt,4,0,"div",4),t._uU(3,"\n                    "),t.YNc(4,nt,4,0,"div",4),t._uU(5,"\n                  "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.serial_number.errors.required),t.xp6(2),t.Q6J("ngIf",n.f.serial_number.errors.pattern)}}function it(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",46),t._uU(1,"\n                  "),t.TgZ(2,"div",47),t._uU(3,"\n                    "),t.TgZ(4,"span"),t._uU(5),t.qZA(),t._uU(6,"\n                    "),t.TgZ(7,"a",48),t.NdJ("click",function(){return t.CHM(n),t.oxw().resetStation()}),t._uU(8," "),t.O4$(),t._UZ(9,"svg",49),t._uU(10," "),t.qZA(),t._uU(11,"\n                  "),t.qZA(),t._uU(12,"\n                "),t.qZA()}if(2&e){const n=t.oxw();t.xp6(5),t.Oqu(n.station.station_name)}}function rt(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"app-station-selection",50),t.NdJ("onSelection",function(c){return t.CHM(n),t.oxw().onStationSelect(c)}),t.qZA()}}function ot(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Station is required."),t.qZA())}function st(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,ot,4,0,"div",4),t._uU(3,"\n                "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.installed_at.errors.required)}}function at(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Icao id is required."),t.qZA())}function ut(e,o){if(1&e&&(t.TgZ(0,"div",45),t._uU(1,"\n                    "),t.YNc(2,at,4,0,"div",4),t._uU(3,"\n                  "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.instrument_uncertainty.errors.required)}}function lt(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," "),t.O4$(),t._UZ(2,"svg",44),t._uU(3," Admin region is required."),t.qZA())}function mt(e,o){if(1&e&&(t.TgZ(0,"div",43),t._uU(1,"\n                  "),t.YNc(2,lt,4,0,"div",4),t._uU(3,"\n                "),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.f.height.errors.required)}}function _t(e,o){1&e&&t._UZ(0,"c-spinner",51)}const b=function(e){return{"is-invalid":e}},ct=function(e){return{"mt-4":e}};let D=(()=>{class e{constructor(n,i,c,Z){this.router=n,this.route=i,this.instService=c,this.stationService=Z,this.form=new l.cw({instrument_id:new l.NI("",l.kI.required,[this.instrumentValidator()]),instrument_name:new l.NI("",l.kI.required),serial_number:new l.NI("",l.kI.required),abbreviation:new l.NI(""),model:new l.NI(""),manufacturer:new l.NI(""),instrument_uncertainty:new l.NI(null),installation_datetime:new l.NI(""),deinstallation_datetime:new l.NI(""),height:new l.NI(""),instrument_picture:new l.NI(null),installed_at:new l.NI(null,l.kI.required)}),this.error="",this.instValidated=!1,this.submitted=!1,this.loading=!1,this.isUpdate=!1}canExit(){return console.log(this.form.dirty),!this.form.dirty||window.confirm("You have unsaved changes. Are you sure you want to leave the page?")}ngOnInit(){this.route.params.pipe((0,a.b)(n=>{this.loading=!!n.id}),(0,_.h)(n=>n.id),(0,m.w)(n=>(this.id=n.id,this.isUpdate=!0,this.form.removeControl("instrument_id"),this.instService.getInstrument(n.id)))).pipe((0,_.h)(n=>n.result&&n.result.length),(0,T.U)(n=>n.result[0]),(0,g.g)(1e3)).subscribe(n=>{console.log(n),this.loading=!1,this.form.patchValue(n),this.loadStation(n.installed_at),this.install=new Date(n.installation_datetime),this.deInstall=new Date(n.deinstallation_datetime),this.minDate=q(this.install).add(1,"day").toDate()})}get f(){return this.form.controls}onStationSelect(n){this.station=n,this.form.controls.installed_at.setValue(n.station_id)}resetStation(){this.station=void 0,this.form.controls.installed_at.reset()}onInstallDateChange(n){n&&(this.form.controls.installation_datetime.setValue(n),this.minDate=q(n).add(1,"day").toDate())}onDeinstallDateChange(n){this.form.controls.deinstallation_datetime.setValue(n)}onSubmit(n){this.submitted=!0,console.log(this.form.value),!this.form.invalid&&(this.isUpdate?this.update():this.addNew())}onReset(){}onCancel(){this.router.navigateByUrl("/instruments")}addNew(){this.imageUploader.upload().pipe((0,u.K)(n=>{throw this.error="Image upload failed",new Error(n.nessage)}),(0,_.h)(n=>n.result&&n.result.length),(0,a.b)(n=>{this.f.instrument_picture.setValue(n.result[0].filepath)}),(0,m.w)(n=>this.instService.addInstrument(this.form.value))).subscribe(n=>{this.form.markAsPristine(),this.router.navigateByUrl("/instruments")})}update(){const n=Object.assign({},this.form.value);""===n.deinstallation_datetime&&(n.deinstallation_datetime=null),this.instService.updateInstrument(this.id,n).subscribe(i=>{(0,A.of)(!0).pipe((0,g.g)(300)).subscribe(()=>{this.form.markAsPristine(),this.router.navigateByUrl("/instruments")})})}loadStation(n){this.stationService.getStation(n).subscribe(i=>{this.station=i.result[0]})}instrumentValidator(){let n="";return i=>i.valueChanges.pipe((0,U.b)(500),(0,_.h)(c=>c.trim().length>0),(0,x.q)(1),(0,a.b)(c=>{n=c,this.instValidated=!1}),(0,m.w)(c=>this.instService.search(c))).pipe((0,T.U)(c=>(this.instValidated=!0,c.result.length>1?c.result.filter(F=>F.id===n).length>0?{instrumentExists:!0}:null:1===c.result.length?{instrumentExists:!0}:null)),(0,u.K)(c=>(0,A.of)(null)))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.F0),t.Y36(d.gz),t.Y36(O.p),t.Y36(N.v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-instrument-form"]],viewQuery:function(n,i){if(1&n&&t.Gf(Y,5),2&n){let c;t.iGM(c=t.CRH())&&(i.imageUploader=c.first)}},decls:206,vars:49,consts:[["xs","12"],[1,"mb-4"],["color","danger",4,"ngIf"],["cForm","","novalidate","","autocomplete","off",3,"formGroup","ngSubmit"],[4,"ngIf"],["xs","12","md","5","xl","4"],[1,"mb-3"],["cLabel","","for","inst_name"],["id","inst_name","formControlName","instrument_name","aria-label","Instrument Name","cFormControl","","placeholder","Instrument Name",3,"ngClass"],["col","12","class","invalid-feedback",4,"ngIf"],["cLabel","","for","inst_abbrev"],["id","inst_abbrev","formControlName","abbreviation","aria-label","Abbreviation","cFormControl","","placeholder","Abbreviation",3,"ngClass"],["cLabel","","for","inst_man"],["id","inst_man","formControlName","manufacturer","aria-label","Manufacturer","cFormControl","","placeholder","Manufacturer",3,"ngClass"],["cLabel","","for","inst_model"],["id","inst_model","formControlName","model","aria-label","Model","cFormControl","","placeholder","Model",3,"ngClass"],["col","12","class","invalid-feedback pl-1",4,"ngIf"],["cLabel","","for","inst_serial"],["id","inst_serial","formControlName","serial_number","aria-label","default input","cFormControl","","placeholder","Serial Number",3,"ngClass"],["cLabel","","for","inst_install_at"],["id","inst_install_at","type","hidden","formControlName","installed_at","aria-label","Installed At","cFormControl","","placeholder","Installed At",3,"ngClass"],["class","typeahead-selection theme form-group",4,"ngIf"],[3,"onSelection",4,"ngIf"],["cLabel","","for","inst_install"],["error","Installation datetime is required.",3,"current","submitted","onChange"],["cLabel","","for","inst_deinstall"],["error","Deinstallation datetime is required.",3,"current","submitted","minDate","onChange"],["cLabel","","for","inst_uncert"],["id","inst_uncert","formControlName","instrument_uncertainty","aria-label","Instrument Uncertainty","cFormControl","","placeholder","Instrument Uncertainty",3,"ngClass"],["cLabel","","for","inst_height"],["id","inst_height","formControlName","height","aria-label","Height","cFormControl","","placeholder","Height",3,"ngClass"],["cLabel","","for","inst_pic"],[3,"feature"],["imageUploader",""],[3,"ngClass"],["type","submit","cButton","","color","dark",1,"px-4"],["aria-hidden","true","size","sm",4,"ngIf"],["type","button","cButton","","color","dark",1,"px-4",3,"click"],["color","danger"],["xs","12","lg","8",1,"py-2"],[1,"mb-2"],["cLabel","","for","instrument_id"],["id","instrument_id","formControlName","instrument_id","aria-label","default input","cFormControl","",3,"ngClass"],["col","12",1,"invalid-feedback"],["cIcon","","name","cilXCircle"],["col","12",1,"invalid-feedback","pl-1"],[1,"typeahead-selection","theme","form-group"],[1,"typeahead-selection-inner"],[1,"btn",3,"click"],["cIcon","","name","cilX"],[3,"onSelection"],["aria-hidden","true","size","sm"]],template:function(n,i){1&n&&(t.TgZ(0,"c-row"),t._uU(1,"\n  "),t.TgZ(2,"c-col",0),t._uU(3,"\n    "),t.TgZ(4,"c-card",1),t._uU(5,"\n      "),t.TgZ(6,"c-card-header"),t._uU(7,"\n        "),t.TgZ(8,"strong"),t._uU(9),t.qZA(),t._uU(10,"\n      "),t.qZA(),t._uU(11,"\n      "),t.TgZ(12,"c-card-body"),t._uU(13,"\n        "),t.YNc(14,S,4,0,"c-alert",2),t._uU(15,"\n        "),t.TgZ(16,"form",3),t.NdJ("ngSubmit",function(Z){return i.onSubmit(Z)}),t._uU(17,"\n          "),t.YNc(18,Q,7,0,"c-row",4),t._uU(19,"\n          "),t.YNc(20,K,15,8,"c-row",4),t._uU(21,"\n          "),t.TgZ(22,"c-row"),t._uU(23,"\n            "),t.TgZ(24,"c-col",5),t._uU(25,"\n              "),t.TgZ(26,"div",6),t._uU(27,"\n                "),t.TgZ(28,"label",7),t._uU(29,"Instrument Name"),t.qZA(),t._uU(30,"\n                "),t._UZ(31,"input",8),t._uU(32,"\n                "),t.YNc(33,R,4,1,"div",9),t._uU(34,"\n              "),t.qZA(),t._uU(35,"\n            "),t.qZA(),t._uU(36,"\n            "),t.TgZ(37,"c-col",5),t._uU(38,"\n              "),t.TgZ(39,"div",6),t._uU(40,"\n                "),t.TgZ(41,"label",10),t._uU(42,"Abbreviation"),t.qZA(),t._uU(43,"\n                "),t._UZ(44,"input",11),t._uU(45,"\n                "),t.YNc(46,W,6,2,"div",9),t._uU(47,"\n              "),t.qZA(),t._uU(48,"\n            "),t.qZA(),t._uU(49,"\n          "),t.qZA(),t._uU(50,"\n          "),t.TgZ(51,"c-row"),t._uU(52,"\n            "),t.TgZ(53,"c-col",5),t._uU(54,"\n              "),t.TgZ(55,"div",6),t._uU(56,"\n                "),t.TgZ(57,"label",12),t._uU(58,"Manufacturer"),t.qZA(),t._uU(59,"\n                "),t._UZ(60,"input",13),t._uU(61,"\n                "),t.YNc(62,G,4,1,"div",9),t._uU(63,"\n              "),t.qZA(),t._uU(64,"\n            "),t.qZA(),t._uU(65,"\n            "),t.TgZ(66,"c-col",5),t._uU(67,"\n              "),t.TgZ(68,"div",6),t._uU(69,"\n                "),t.TgZ(70,"label",14),t._uU(71,"Model"),t.qZA(),t._uU(72,"\n                "),t._UZ(73,"input",15),t._uU(74,"\n                  "),t.YNc(75,X,4,1,"div",16),t._uU(76,"\n              "),t.qZA(),t._uU(77,"\n            "),t.qZA(),t._uU(78,"\n          "),t.qZA(),t._uU(79,"\n          "),t.TgZ(80,"c-row"),t._uU(81,"\n            "),t.TgZ(82,"c-col",5),t._uU(83,"\n              "),t.TgZ(84,"div",6),t._uU(85,"\n                "),t.TgZ(86,"label",17),t._uU(87,"Serial Number"),t.qZA(),t._uU(88,"\n                "),t._UZ(89,"input",18),t._uU(90,"\n                  "),t.YNc(91,et,6,2,"div",16),t._uU(92,"\n              "),t.qZA(),t._uU(93,"\n            "),t.qZA(),t._uU(94,"\n            "),t.TgZ(95,"c-col",5),t._uU(96,"\n              "),t.TgZ(97,"div",6),t._uU(98,"\n                "),t.TgZ(99,"label",19),t._uU(100,"Installed At"),t.qZA(),t._uU(101,"\n                "),t._UZ(102,"input",20),t._uU(103,"\n                "),t.YNc(104,it,13,1,"div",21),t._uU(105,"\n                "),t.YNc(106,rt,1,0,"app-station-selection",22),t._uU(107,"\n                "),t.YNc(108,st,4,1,"div",9),t._uU(109,"\n              "),t.qZA(),t._uU(110,"\n            "),t.qZA(),t._uU(111,"\n          "),t.qZA(),t._uU(112,"\n          "),t.TgZ(113,"c-row"),t._uU(114,"\n            "),t.TgZ(115,"c-col",5),t._uU(116,"\n              "),t.TgZ(117,"div",6),t._uU(118,"\n                "),t.TgZ(119,"label",23),t._uU(120,"Installation Date/Time"),t.qZA(),t._uU(121,"\n                "),t.TgZ(122,"app-data-time",24),t.NdJ("onChange",function(Z){return i.onInstallDateChange(Z)}),t.qZA(),t._uU(123,"\n              "),t.qZA(),t._uU(124,"\n            "),t.qZA(),t._uU(125,"\n            "),t.TgZ(126,"c-col",5),t._uU(127,"\n              "),t.TgZ(128,"div",6),t._uU(129,"\n                "),t.TgZ(130,"label",25),t._uU(131,"Deinstallation Date/Time"),t.qZA(),t._uU(132,"\n                "),t.TgZ(133,"app-data-time",26),t.NdJ("onChange",function(Z){return i.onDeinstallDateChange(Z)}),t.qZA(),t._uU(134,"\n              "),t.qZA(),t._uU(135,"\n            "),t.qZA(),t._uU(136,"\n          "),t.qZA(),t._uU(137,"\n          "),t.TgZ(138,"c-row"),t._uU(139,"\n            "),t.TgZ(140,"c-col",5),t._uU(141,"\n              "),t.TgZ(142,"div",6),t._uU(143,"\n                "),t.TgZ(144,"label",27),t._uU(145,"Uncertainty"),t.qZA(),t._uU(146,"\n                "),t._UZ(147,"input",28),t._uU(148,"\n                  "),t.YNc(149,ut,4,1,"div",16),t._uU(150,"\n              "),t.qZA(),t._uU(151,"\n            "),t.qZA(),t._uU(152,"\n            "),t.TgZ(153,"c-col",5),t._uU(154,"\n              "),t.TgZ(155,"div",6),t._uU(156,"\n                "),t.TgZ(157,"label",29),t._uU(158,"Height"),t.qZA(),t._uU(159,"\n                "),t._UZ(160,"input",30),t._uU(161,"\n                "),t.YNc(162,mt,4,1,"div",9),t._uU(163,"\n              "),t.qZA(),t._uU(164,"\n            "),t.qZA(),t._uU(165,"\n          "),t.qZA(),t._uU(166,"\n          "),t.TgZ(167,"c-row"),t._uU(168,"\n\n          "),t.qZA(),t._uU(169,"\n          "),t.TgZ(170,"c-row"),t._uU(171,"\n            "),t.TgZ(172,"c-col",5),t._uU(173,"\n              "),t.TgZ(174,"div",6),t._uU(175,"\n                "),t.TgZ(176,"label",31),t._uU(177,"Instrument Picture"),t.qZA(),t._uU(178,"\n                "),t._UZ(179,"app-image-uploader",32,33),t._uU(181,"\n              "),t.qZA(),t._uU(182,"\n            "),t.qZA(),t._uU(183,"\n          "),t.qZA(),t._uU(184,"\n          "),t.TgZ(185,"c-row",34),t._uU(186,"\n            "),t.TgZ(187,"c-col",0),t._uU(188,"\n              "),t.TgZ(189,"button",35),t._uU(190,"\n                "),t.YNc(191,_t,1,0,"c-spinner",36),t._uU(192," Submit "),t.qZA(),t._uU(193,"\n              "),t.TgZ(194,"button",37),t.NdJ("click",function(){return i.onReset()}),t._uU(195," Reset "),t.qZA(),t._uU(196,"\n              "),t.TgZ(197,"button",37),t.NdJ("click",function(){return i.onCancel()}),t._uU(198," Cancel "),t.qZA(),t._uU(199,"\n            "),t.qZA(),t._uU(200,"\n          "),t.qZA(),t._uU(201,"\n        "),t.qZA(),t._uU(202,"\n      "),t.qZA(),t._uU(203,"\n    "),t.qZA(),t._uU(204,"\n  "),t.qZA(),t._uU(205,"\n"),t.qZA()),2&n&&(t.xp6(9),t.hij("",i.isUpdate?"Update":"Add"," Instrument"),t.xp6(5),t.Q6J("ngIf",i.submitted&&i.form.invalid),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(2),t.Q6J("ngIf",i.loading),t.xp6(2),t.Q6J("ngIf",!i.isUpdate),t.xp6(11),t.Q6J("ngClass",t.VKq(31,b,(i.submitted||i.f.instrument_name.touched)&&i.f.instrument_name.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.instrument_name.errors),t.xp6(11),t.Q6J("ngClass",t.VKq(33,b,(i.submitted||i.f.abbreviation.touched)&&i.f.abbreviation.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.abbreviation.errors),t.xp6(14),t.Q6J("ngClass",t.VKq(35,b,(i.submitted||i.f.manufacturer.touched)&&i.f.manufacturer.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.manufacturer.errors),t.xp6(11),t.Q6J("ngClass",t.VKq(37,b,(i.submitted||i.f.model.touched)&&i.f.model.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.model.errors),t.xp6(14),t.Q6J("ngClass",t.VKq(39,b,(i.submitted||i.f.serial_number.touched)&&i.f.serial_number.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.serial_number.errors),t.xp6(11),t.Q6J("ngClass",t.VKq(41,b,(i.submitted||i.f.installed_at.touched)&&i.f.installed_at.invalid)),t.xp6(2),t.Q6J("ngIf",i.station),t.xp6(2),t.Q6J("ngIf",!i.station),t.xp6(2),t.Q6J("ngIf",i.f.installed_at.errors),t.xp6(14),t.Q6J("current",i.f.installation_datetime.value)("submitted",i.submitted),t.xp6(11),t.Q6J("current",i.f.deinstallation_datetime.value)("submitted",i.submitted)("minDate",i.minDate),t.xp6(14),t.Q6J("ngClass",t.VKq(43,b,(i.submitted||i.f.instrument_uncertainty.touched)&&i.f.instrument_uncertainty.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.instrument_uncertainty.errors),t.xp6(11),t.Q6J("ngClass",t.VKq(45,b,(i.submitted||i.f.height.touched)&&i.f.height.invalid)),t.xp6(2),t.Q6J("ngIf",i.f.height.errors),t.xp6(17),t.Q6J("feature","feature"),t.xp6(6),t.Q6J("ngClass",t.VKq(47,ct,!i.error)),t.xp6(6),t.Q6J("ngIf",i.loading))},directives:[p.iok,p.Yp0,p.AkF,p.nkx,p.yue,f.O5,l._Y,l.JL,p.$_X,l.sg,p.eFW,l.Fj,p.oHf,l.JJ,l.u,f.mk,w.o,E.$,p.Hq3,p.wxo,M.$,y.ar,J.n,p.ORR],styles:[""]}),e})();var dt=r(2719),gt=r(4437),pt=r(5261);const ft=function(e){return["/instruments",e]},Ut=function(e){return["/instruments",e,"update"]};function Zt(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"tr"),t._uU(1,"\n            "),t.TgZ(2,"th",13),t._uU(3),t.qZA(),t._uU(4,"\n            "),t.TgZ(5,"td",10),t._uU(6),t.qZA(),t._uU(7,"\n            "),t.TgZ(8,"td",10),t._uU(9),t.qZA(),t._uU(10,"\n            "),t.TgZ(11,"td",10),t._uU(12),t.qZA(),t._uU(13,"\n            "),t.TgZ(14,"td",10),t._uU(15),t.qZA(),t._uU(16,"\n            "),t.TgZ(17,"td",10),t._uU(18),t.qZA(),t._uU(19,"\n            "),t.TgZ(20,"td",10),t._uU(21),t.qZA(),t._uU(22,"\n            "),t.TgZ(23,"td",10),t._uU(24),t.ALo(25,"date"),t.qZA(),t._uU(26,"\n            "),t.TgZ(27,"td",10),t._uU(28),t.ALo(29,"date"),t.qZA(),t._uU(30,"\n            "),t.TgZ(31,"td"),t._uU(32,"\n              "),t.TgZ(33,"button",14),t._uU(34,"\n                "),t.O4$(),t._UZ(35,"svg",15),t._uU(36,"\n              "),t.qZA(),t._uU(37,"\n              "),t.kcU(),t.TgZ(38,"button",16),t._uU(39,"\n                "),t.O4$(),t._UZ(40,"svg",17),t._uU(41,"\n              "),t.qZA(),t._uU(42,"\n              "),t.kcU(),t.TgZ(43,"button",18),t.NdJ("click",function(){const Z=t.CHM(n).$implicit;return t.oxw(2).remove(Z)}),t._uU(44,"\n                "),t.O4$(),t._UZ(45,"svg",19),t._uU(46,"\n              "),t.qZA(),t._uU(47,"\n            "),t.qZA(),t._uU(48,"\n          "),t.qZA()}if(2&e){const n=o.$implicit;t.xp6(3),t.Oqu(n.instrument_id),t.xp6(3),t.AsE("[",n.abbreviation,"] ",n.instrument_name,""),t.xp6(3),t.Oqu(n.serial_number),t.xp6(3),t.Oqu(n.model),t.xp6(3),t.Oqu(n.manufacturer),t.xp6(3),t.Oqu(n.height),t.xp6(3),t.Oqu(n.instrument_uncertainty),t.xp6(3),t.Oqu(t.xi3(25,12,n.installation_datetime,"dd MMM YYYY hh:mm")),t.xp6(4),t.Oqu(t.xi3(29,15,n.deinstallation_datetime,"dd MMM YYYY hh:mm")),t.xp6(5),t.Q6J("routerLink",t.VKq(18,ft,n.instrument_id)),t.xp6(5),t.Q6J("routerLink",t.VKq(20,Ut,n.instrument_id))}}function ht(e,o){1&e&&(t.TgZ(0,"c-alert",20),t.TgZ(1,"strong"),t._uU(2,"Info"),t.qZA(),t._uU(3," No instruments available to show. "),t.qZA())}function vt(e,o){if(1&e){const n=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"c-card-body"),t._uU(1,"\n        "),t.TgZ(2,"app-paginator",8),t.NdJ("onPage",function(c){return t.CHM(n),t.oxw().onPage(c)}),t.qZA(),t._uU(3,"\n        "),t.TgZ(4,"table",9),t._uU(5,"\n          "),t.TgZ(6,"thead"),t._uU(7,"\n          "),t.TgZ(8,"tr"),t._uU(9,"\n            "),t.TgZ(10,"th",10),t._uU(11,"ID"),t.qZA(),t._uU(12,"\n            "),t.TgZ(13,"th",10),t._uU(14,"Name"),t.qZA(),t._uU(15,"\n            "),t.TgZ(16,"th",10),t._uU(17,"Serial"),t.qZA(),t._uU(18,"\n            "),t.TgZ(19,"th",10),t._uU(20,"Model"),t.qZA(),t._uU(21,"\n            "),t.TgZ(22,"th",10),t._uU(23,"Manufacturer"),t.qZA(),t._uU(24,"\n            "),t.TgZ(25,"th",10),t._uU(26,"Height"),t.qZA(),t._uU(27,"\n            "),t.TgZ(28,"th",10),t._uU(29,"Uncertainty"),t.qZA(),t._uU(30,"\n            "),t.TgZ(31,"th",10),t._uU(32,"Installation"),t.qZA(),t._uU(33,"\n            "),t.TgZ(34,"th",10),t._uU(35,"De-Installation"),t.qZA(),t._uU(36,"\n            "),t._UZ(37,"th"),t._uU(38,"\n          "),t.qZA(),t._uU(39,"\n          "),t.qZA(),t._uU(40,"\n          "),t.TgZ(41,"tbody"),t._uU(42,"\n          "),t.YNc(43,Zt,49,22,"tr",11),t._uU(44,"\n          "),t.qZA(),t._uU(45,"\n        "),t.qZA(),t._uU(46,"\n        "),t.YNc(47,ht,4,0,"c-alert",12),t._uU(48,"\n      "),t.qZA()}if(2&e){const n=o.$implicit,i=t.oxw();t.xp6(2),t.Q6J("limit",n.limit)("current",n.page)("pages",i.createPages(n.pages)),t.xp6(41),t.Q6J("ngForOf",n.instruments),t.xp6(4),t.Q6J("ngIf",!n.instruments.length)}}const Tt=function(){return["/instruments","new"]},It=[{path:"",component:(()=>{class e{constructor(n,i){this.instService=n,this.modalService=i,this.instruments$=(0,A.of)({instruments:[],limit:1,page:1,pages:1})}ngOnInit(){this.instruments$=this.instService.instruments}remove(n){this.modalService.show(dt.S,{initialState:{title:"Instrument Removal",message:"Operation cannot be undone. Are you sure you want to remove the instrument and its associated data?",confirm:"Go Ahead",cancel:"Cancel"}}).content.onClose.subscribe(Z=>{Z&&n.instrument_id&&this.instService.removeInstrument(n.instrument_id)})}onPage(n){console.log(n),this.instService.updateState(n)}createPages(n){return[...Array(n).keys()].map(i=>i+1)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(O.p),t.Y36(gt.tT))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-instruments"]],decls:31,vars:5,consts:[["xs","12","lg","12","xl","12"],[1,"mb-4"],["xs","6"],[1,"col-6"],["xs","6",1,"text-end"],[1,"btn","btn-sm","cs-btn-sm","btn-outline",3,"routerLink"],["cIcon","","name","cilPlus"],[4,"ngIf"],[3,"limit","current","pages","onPage"],["cTable",""],["scope","col"],[4,"ngFor","ngForOf"],["color","primary",4,"ngIf"],["scope","row"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","View Station",3,"routerLink"],["cIcon","","name","cilArrowThickFromLeft","size","sm"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Update Station",3,"routerLink"],["cIcon","","name","cilPencil","size","sm"],["cButton","","size","sm","color","light","shape","rounded-pill","cTooltip","Remove Station",3,"click"],["cIcon","","name","cilTrash","size","sm",1,"text-danger"],["color","primary"]],template:function(n,i){1&n&&(t.TgZ(0,"c-row"),t._uU(1,"\n  "),t.TgZ(2,"c-col",0),t._uU(3,"\n    "),t.TgZ(4,"c-card",1),t._uU(5,"\n      "),t.TgZ(6,"c-card-header"),t._uU(7,"\n        "),t.TgZ(8,"c-row"),t._uU(9,"\n          "),t.TgZ(10,"c-col",2),t._uU(11,"\n            "),t.TgZ(12,"strong",3),t._uU(13,"Instruments"),t.qZA(),t._uU(14,"\n          "),t.qZA(),t._uU(15,"\n          "),t.TgZ(16,"c-col",4),t._uU(17,"\n            "),t.TgZ(18,"a",5),t._uU(19," "),t.O4$(),t._UZ(20,"svg",6),t._uU(21," Add New "),t.qZA(),t._uU(22,"\n          "),t.qZA(),t._uU(23,"\n        "),t.qZA(),t._uU(24,"\n      "),t.qZA(),t._uU(25,"\n      "),t.YNc(26,vt,49,5,"c-card-body",7),t.ALo(27,"async"),t._uU(28,"\n    "),t.qZA(),t._uU(29,"\n  "),t.qZA(),t._uU(30,"\n"),t.qZA()),2&n&&(t.xp6(18),t.Q6J("routerLink",t.DdM(4,Tt)),t.xp6(8),t.Q6J("ngIf",t.lcZ(27,2,i.instruments$)))},directives:[p.iok,p.Yp0,p.AkF,p.nkx,d.yS,y.ar,f.O5,p.yue,pt.J,p.auY,f.sg,p.Hq3,p.i9q,d.rH,p.wxo],pipes:[f.Ov,f.uU],styles:[""]}),e})(),data:{title:"Instruments"}},{path:"new",component:D,canDeactivate:[h.C],data:{title:"New Instrument",update:!1}},{path:":id/update",component:D,data:{title:"Update Instrument",update:!0}},{path:":id",component:v,data:{title:"Instrument"}}];let bt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.Bz.forChild(It)],d.Bz]}),e})(),At=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.ez,bt,s.m]]}),e})()},9844:(C,I,r)=>{r.d(I,{p:()=>l});var s=r(4499),f=r(2835),d=r(7384),h=r(3668),t=r(453);const v="climsoft/v1";let l=(()=>{class T{constructor(a){this.http=a,this.instruments$=new s.X({instruments:[],limit:10,page:1,pages:1}),this.init=!1;const _=this.instruments$.getValue();this.getInstruments(_.page,_.limit)}get instruments(){return this.instruments$.asObservable()}adapt(a){const _={instrument_id:"",instrument_name:"Instrument Name",serial_number:"Serial Number",abbreviation:"Abbreviation",model:"Model",manufacturer:"Manufacturer",instrument_uncertainty:"Instrument Uncertainty",installation_datetime:"Installation DateTime",deinstallation_datetime:"Deinstallation DateTime",height:"Height",instrument_picture:"Instrument Picture",installed_at:"Installed At"};let m=[];return Object.keys(a).filter(g=>-1===["instrument_id","instrument_name"].indexOf(g)).forEach(g=>{const u={};switch(u.key=_[g],u.value=a[g]||"No Value",g){case"installation_datetime":case"deinstallation_datetime":u.type="date";break;default:u.type=null}m.push(u)}),m}addInstrument(a){return this.http.POST(`${v}/instruments`,Object.assign(Object.assign({},a),{installation_datetime:a.installation_datetime.toISOString(),deinstallation_datetime:a.deinstallation_datetime.toISOString()})).pipe((0,f.K)(_=>{throw new Error(_.error.message)}),(0,d.b)(_=>{console.log(_);const m=this.instruments$.getValue(),{page:g,limit:u}=m;this.getInstruments(g,u)}))}search(a){return this.http.GET(`${v}/instruments/search?query=${a}`)}updateState(a){if(a.page){const _=this.instruments$.getValue().limit;this.getInstruments(a.page,_)}a.limit&&this.getInstruments(1,a.limit)}getInstruments(a,_){console.log(a,_),this.http.GET(`${v}/instruments?limit=${_}&offset=${(a-1)*_}`).subscribe(g=>{console.log(g),this.instruments$.next({instruments:g.result,limit:_,page:g.page,pages:g.pages}),this.init=!0})}getInstrument(a){return this.http.GET(`${v}/instruments/${a}`)}updateInstrument(a,_){return this.http.PUT(`${v}/instruments/${a}`,_).pipe((0,f.K)(m=>{throw new Error(m.error.message)}),(0,d.b)(m=>{const g=this.instruments$.getValue(),{page:u,limit:U}=g;this.getInstruments(u,U)}))}removeInstrument(a){this.http.DELETE(`${v}/instruments/${a}`).pipe((0,f.K)(_=>{throw new Error(_.error.message)})).subscribe(_=>{const m=this.instruments$.getValue(),{page:g,limit:u}=m;this.getInstruments(g,u)})}}return T.\u0275fac=function(a){return new(a||T)(h.LFG(t.O))},T.\u0275prov=h.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},2409:(C,I,r)=>{r.d(I,{o:()=>_});var s=r(3668),f=r(2070),h=r(6019),t=r(2606),v=r(8063),l=r(4859);function T(m,g){if(1&m&&(s.TgZ(0,"div",6),s.O4$(),s._UZ(1,"svg",7),s._uU(2),s.qZA()),2&m){const u=s.oxw();s.xp6(2),s.hij(" ",u.error,". ")}}const A=function(m){return{invalid:m}},a=function(m){return{"is-invalid":m}};let _=(()=>{class m{constructor(){this.submitted=!1,this.onChange=new s.vpe,this.focused=!1,this.invalid=!1,this.bsConfig={isAnimated:!0,withTimepicker:!0,dateInputFormat:"DD/MM/YYYY HH:mm"}}ngOnInit(){this.current=this.current?new Date(this.current):new Date,this.bsValue=new Date(this.current);const u=f(this.current);this.invalid=!this.current||!u.isValid()}onDateChanged(u){u&&(this.bsValue.setFullYear(u.getFullYear(),u.getMonth(),u.getDate()),this.onChange.emit(this.bsValue))}}return m.\u0275fac=function(u){return new(u||m)},m.\u0275cmp=s.Xpm({type:m,selectors:[["app-data-time"]],inputs:{submitted:"submitted",current:"current",error:"error",minDate:"minDate"},outputs:{onChange:"onChange"},decls:6,vars:10,consts:[[1,"mx-0","px-0","align-items-center",3,"ngClass"],[1,"mb-3"],["cInputGroupText","","id","basic-addon1"],["cIcon","","name","cilCalendar"],["type","text","placeholder","Select Date","cFormControl","","bsDatepicker","",3,"bsValue","ngClass","bsConfig","minDate","bsValueChange"],["sm","12","class","invalid-feedback",4,"ngIf"],["sm","12",1,"invalid-feedback"],["cIcon","","name","cilXCircle"]],template:function(u,U){1&u&&(s.TgZ(0,"div",0),s.TgZ(1,"c-input-group",1),s.TgZ(2,"span",2),s.O4$(),s._UZ(3,"svg",3),s.qZA(),s.kcU(),s.TgZ(4,"input",4),s.NdJ("bsValueChange",function(q){return U.onDateChanged(q)}),s.qZA(),s.YNc(5,T,3,1,"div",5),s.qZA(),s.qZA()),2&u&&(s.Q6J("ngClass",s.VKq(6,A,U.submitted&&U.invalid)),s.xp6(4),s.Q6J("bsValue",U.bsValue)("ngClass",s.VKq(8,a,U.submitted&&U.invalid))("bsConfig",U.bsConfig)("minDate",U.minDate),s.xp6(1),s.Q6J("ngIf",U.submitted&&U.invalid))},directives:[h.mk,t.g8K,t.jOm,v.ar,t.oHf,l.Y5,l.Np,h.O5],styles:[".row[_ngcontent-%COMP%]{border:1px solid #d8dfe3;border-radius:.2rem;padding:.2rem .3rem!important;background-color:#e8f1f6}.row.invalid[_ngcontent-%COMP%]{border-color:#eac6c1;background-color:#ffe2de}"]}),m})()},4379:(C,I,r)=>{r.d(I,{$:()=>f});var s=r(3668);let f=(()=>{class d{constructor(){}ngOnInit(){}}return d.\u0275fac=function(t){return new(t||d)},d.\u0275cmp=s.Xpm({type:d,selectors:[["app-infinite-loading"]],decls:2,vars:0,consts:[[1,"infinite-loader"],[1,"loader-bar"]],template:function(t,v){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"div",1),s.qZA())},styles:['.infinite-loader[_ngcontent-%COMP%]{width:100%;margin:0 auto;border-radius:10px;border:4px solid transparent;position:relative;padding:1px}.infinite-loader[_ngcontent-%COMP%]:before{content:"";border:1px solid #1697ec;border-radius:10px;position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px}.infinite-loader[_ngcontent-%COMP%]   .loader-bar[_ngcontent-%COMP%]{position:absolute;border-radius:10px;top:0;right:100%;bottom:0;left:0;background:#1697ec;width:0;animation:borealisBar 1s linear infinite}@keyframes borealisBar{0%{left:0%;right:100%;width:0%}10%{left:0%;right:75%;width:25%}90%{right:0%;left:75%;width:25%}to{left:100%;right:0%;width:0%}}']}),d})()}}]);